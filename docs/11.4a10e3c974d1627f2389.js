(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{ImkO:function(t,i,e){"use strict";e.r(i);var n=e("Valr"),a=e("ea4N"),c=e("cPJV"),s=e("ETwC"),r=e("mrSG"),o=e("gSfl"),l=function(t){function i(){var i=t.call(this)||this;return i.sales=0,i}return Object(r.b)(i,t),i.prototype.computeSales=function(){var t=this;this.transaction_items&&(this.sales=0,this.transaction_items.forEach((function(i){t.sales+=i.total})))},i}(o.a),b=function(t){function i(){var i=t.call(this)||this;return i.reset(),i}return Object(r.b)(i,t),i.prototype.markAsValid=function(){this._valid=!0},Object.defineProperty(i.prototype,"valid",{get:function(){return this._valid},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"is_ready",{get:function(){return 1==this.type&&null!=this.paper_size_id&&null!=this.print_quality_id||2==this.type},enumerable:!0,configurable:!0}),i.prototype.reset=function(){this._valid=!1,this.type=1,this.paper_size_id=null,this.print_quality_id=null,this.quantity=1,this.price=0,this.total=0},Object.defineProperty(i.prototype,"is_printing",{get:function(){return 1==this.type},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"is_scanning",{get:function(){return 2==this.type},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"type_label",{get:function(){return 1==this.type?"Print":"Scan"},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"computed_total",{get:function(){return this.quantity*this.price},enumerable:!0,configurable:!0}),i}(o.a),u=e("TYT/"),m=e("WHFS"),d=e("fB3y"),f=e("cUzu"),p=function(t){function i(i){return t.call(this,i,"service-transactions")||this}return Object(r.b)(i,t),i.\u0275fac=function(t){return new(t||i)(u.ec(f.b))},i.\u0275prov=u.Mb({token:i,factory:i.\u0275fac,providedIn:"root"}),i}(d.a),h=e("eHTH"),v=e("agxM"),g=e("QJY3"),_=e("cSbt"),y=e("p+mS"),I=e("GsDI"),C=e("MqYC"),V=["cancelButton"];function W(t,i){if(1&t&&(u.Wb(0,"mat-option",33),u.Kc(1),u.Vb()),2&t){var e=i.$implicit;u.sc("value",e.id),u.Cb(1),u.Mc(" ",e.fullname," ")}}function S(t,i){1&t&&(u.Wb(0,"th",34),u.Kc(1," Type "),u.Vb())}function w(t,i){if(1&t&&(u.Wb(0,"span"),u.Kc(1),u.Vb()),2&t){var e=u.mc().$implicit;u.Cb(1),u.Lc(e.type_label)}}function T(t,i){if(1&t&&(u.Wb(0,"mat-option",33),u.Kc(1),u.Vb()),2&t){var e=i.$implicit;u.sc("value",e.key),u.Cb(1),u.Lc(e.value)}}function D(t,i){if(1&t){var e=u.Xb();u.Wb(0,"mat-form-field"),u.Wb(1,"mat-select",37),u.ic("ngModelChange",(function(t){return u.Bc(e),u.mc().$implicit.type=t}))("selectionChange",(function(t){u.Bc(e);var i=u.mc().$implicit;return u.mc().setPrice(i)})),u.Ic(2,T,2,2,"mat-option",7),u.Vb(),u.Vb()}if(2&t){var n=u.mc().$implicit,a=u.mc();u.Cb(1),u.sc("ngModel",n.type),u.Cb(1),u.sc("ngForOf",a.station.service_types)}}function K(t,i){if(1&t&&(u.Wb(0,"td",35),u.Ic(1,w,2,1,"span",36),u.Ic(2,D,3,2,"mat-form-field",36),u.Vb()),2&t){var e=i.$implicit;u.Cb(1),u.sc("ngIf",e.valid),u.Cb(1),u.sc("ngIf",!e.valid)}}function q(t,i){1&t&&(u.Wb(0,"th",34),u.Kc(1," Size "),u.Vb())}function M(t,i){if(1&t&&(u.Wb(0,"span"),u.Kc(1),u.Vb()),2&t){var e=u.mc().$implicit;u.Cb(1),u.Lc(e.is_scanning?"N/A":e.paper_size.description)}}function z(t,i){if(1&t&&(u.Wb(0,"mat-option",33),u.Kc(1),u.Vb()),2&t){var e=i.$implicit;u.sc("value",e.id),u.Cb(1),u.Lc(e.description)}}function $(t,i){if(1&t){var e=u.Xb();u.Wb(0,"mat-form-field"),u.Wb(1,"mat-select",38),u.ic("ngModelChange",(function(t){return u.Bc(e),u.mc().$implicit.paper_size_id=t}))("selectionChange",(function(t){u.Bc(e);var i=u.mc().$implicit;return u.mc().setPrice(i)})),u.Ic(2,z,2,2,"mat-option",7),u.Vb(),u.Vb()}if(2&t){var n=u.mc().$implicit,a=u.mc();u.Cb(1),u.sc("disabled",n.is_scanning)("ngModel",n.paper_size_id),u.Cb(1),u.sc("ngForOf",a.paper_sizes)}}function k(t,i){if(1&t&&(u.Wb(0,"td",35),u.Ic(1,M,2,1,"span",36),u.Ic(2,$,3,3,"mat-form-field",36),u.Vb()),2&t){var e=i.$implicit;u.Cb(1),u.sc("ngIf",e.valid),u.Cb(1),u.sc("ngIf",!e.valid)}}function R(t,i){1&t&&(u.Wb(0,"th",34),u.Kc(1," Quality "),u.Vb())}function O(t,i){if(1&t&&(u.Wb(0,"span"),u.Kc(1),u.Vb()),2&t){var e=u.mc().$implicit;u.Cb(1),u.Lc(e.is_scanning?"N/A":e.print_quality.description)}}function L(t,i){if(1&t&&(u.Wb(0,"mat-option",33),u.Kc(1),u.Vb()),2&t){var e=i.$implicit;u.sc("value",e.id),u.Cb(1),u.Lc(e.description)}}function Q(t,i){if(1&t){var e=u.Xb();u.Wb(0,"mat-form-field"),u.Wb(1,"mat-select",40),u.ic("ngModelChange",(function(t){return u.Bc(e),u.mc().$implicit.print_quality_id=t}))("selectionChange",(function(t){u.Bc(e);var i=u.mc().$implicit;return u.mc().setPrice(i)})),u.Ic(2,L,2,2,"mat-option",7),u.Vb(),u.Vb()}if(2&t){var n=u.mc().$implicit,a=u.mc();u.Cb(1),u.sc("disabled",n.is_scanning)("ngModel",n.print_quality_id),u.Cb(1),u.sc("ngForOf",a.print_qualities)}}function x(t,i){if(1&t&&(u.Wb(0,"td",39),u.Ic(1,O,2,1,"span",36),u.Ic(2,Q,3,3,"mat-form-field",36),u.Vb()),2&t){var e=i.$implicit;u.Cb(1),u.sc("ngIf",e.valid),u.Cb(1),u.sc("ngIf",!e.valid)}}function P(t,i){1&t&&(u.Wb(0,"th",34),u.Kc(1," Quantity "),u.Vb())}function j(t,i){if(1&t){var e=u.Xb();u.Wb(0,"mat-form-field"),u.Wb(1,"input",42),u.ic("ngModelChange",(function(t){return u.Bc(e),u.mc().$implicit.quantity=t})),u.Vb(),u.Vb()}if(2&t){var n=u.mc().$implicit;u.Cb(1),u.sc("ngModel",n.quantity)}}function B(t,i){if(1&t&&(u.Wb(0,"td",41),u.Ic(1,j,2,1,"mat-form-field",36),u.Vb()),2&t){var e=i.$implicit;u.Cb(1),u.sc("ngIf",e.is_ready)}}function U(t,i){1&t&&(u.Wb(0,"th",43),u.Kc(1," Price "),u.Vb())}function F(t,i){if(1&t&&(u.Wb(0,"span"),u.Kc(1),u.Vb()),2&t){var e=u.mc().$implicit;u.Cb(1),u.Lc(e.price)}}function A(t,i){if(1&t&&(u.Wb(0,"td",41),u.Ic(1,F,2,1,"span",36),u.Vb()),2&t){var e=i.$implicit;u.Cb(1),u.sc("ngIf",e.is_ready)}}function H(t,i){1&t&&(u.Wb(0,"th",44),u.Kc(1," Amount "),u.Vb())}function Y(t,i){if(1&t&&(u.Wb(0,"span"),u.Kc(1),u.Vb()),2&t){var e=u.mc().$implicit;u.Cb(1),u.Lc(e.computed_total)}}function N(t,i){if(1&t&&(u.Wb(0,"td",41),u.Ic(1,Y,2,1,"span",36),u.Vb()),2&t){var e=i.$implicit;u.Cb(1),u.sc("ngIf",e.is_ready)}}function J(t,i){1&t&&u.Rb(0,"th",45)}function X(t,i){1&t&&(u.Wb(0,"mat-icon"),u.Kc(1,"remove"),u.Vb())}function E(t,i){1&t&&(u.Wb(0,"mat-icon"),u.Kc(1,"refresh"),u.Vb())}function G(t,i){if(1&t){var e=u.Xb();u.Wb(0,"button",48),u.ic("click",(function(t){u.Bc(e);var i=u.mc().$implicit;return u.mc().removeItem(i)})),u.Ic(1,X,2,0,"mat-icon",36),u.Ic(2,E,2,0,"mat-icon",36),u.Vb()}if(2&t){var n=u.mc().$implicit,a=u.mc();u.sc("disabled",a.savingTransaction),u.Cb(1),u.sc("ngIf",n.valid),u.Cb(1),u.sc("ngIf",n.dirty&&a.transaction.transaction_items.length>1)}}function Z(t,i){if(1&t&&(u.Wb(0,"td",46),u.Ic(1,G,3,3,"button",47),u.Vb()),2&t){var e=i.$implicit,n=u.mc();u.Cb(1),u.sc("ngIf",e.valid||n.transaction.transaction_items.length>1)}}function tt(t,i){1&t&&u.Rb(0,"tr",49)}function it(t,i){1&t&&u.Rb(0,"tr",50)}function et(t,i){if(1&t){var e=u.Xb();u.Wb(0,"button",31),u.ic("click",(function(t){return u.Bc(e),u.mc().addItem()})),u.Rb(1,"i",51),u.Vb()}if(2&t){var n=u.mc();u.sc("disabled",n.savingTransaction)}}var nt=function(){function t(t,i,e,n){this.dialogRef=t,this.modalService=i,this.serviceTransactionService=e,this.matData=n,this.members=[{id:"1",fullname:"Anonymous"}],this.transactionItemTableColumns=["type","size","quality","quantity","price","total","action"],this.savingTransaction=!1,this.service_rates=[],this.transaction=new l,this.transaction.member_id="1",this.transaction.timeFormatted=c(new Date,"MMM DD, YYYY hh:mm A"),this.currentTransactionItem=new b,this.transaction.transaction_items=[this.currentTransactionItem],this.mds=new s.k(this.transaction.transaction_items),this.station=this.matData.station,this.paper_sizes=this.matData.paper_sizes,this.print_qualities=this.matData.print_qualities,this.service_rates=this.matData.service_rates}return t.prototype.ngOnInit=function(){},t.prototype.ngAfterViewInit=function(){},t.prototype.addItem=function(){this.currentTransactionItem.is_ready&&(this.checkDuplicates()||(this.currentTransactionItem.markAsValid(),this.currentTransactionItem=new b,this.transaction.transaction_items.push(this.currentTransactionItem)),this.mds.connect().next(this.transaction.transaction_items),this.transaction.computeSales())},t.prototype.checkDuplicates=function(){var t=this,i=!1;return this.transaction.transaction_items.forEach((function(e,n){!i&&t.currentTransactionItem.is_printing&&e.valid&&e.paper_size_id===t.currentTransactionItem.paper_size_id&&e.print_quality_id===t.currentTransactionItem.print_quality_id&&(i=!0,e.quantity+=t.currentTransactionItem.quantity,t.currentTransactionItem.reset()),!i&&t.currentTransactionItem.is_scanning&&e.is_scanning&&e.valid&&(i=!0,e.quantity+=t.currentTransactionItem.quantity,t.currentTransactionItem.reset())})),i},t.prototype.removeItem=function(t){t.valid&&(this.transaction.transaction_items=this.transaction.transaction_items.filter((function(i){return!(i.type==t.type&&i.paper_size_id==t.paper_size_id&&i.print_quality_id==t.print_quality_id&&i.valid)}))),this.mds.connect().next(this.transaction.transaction_items)},t.prototype.saveTransaction=function(){var t=this;this.modalService.confirm({message:"Save this transaction?"}).then((function(i){i&&(t.checkDuplicates(),t.currentTransactionItem.is_ready&&t.addItem(),t.transaction.transaction_items=t.transaction.transaction_items.filter((function(t){return t.valid})),t.transaction.station_id=t.station.id,t.savingTransaction=!0,t.serviceTransactionService.create(t.transaction).subscribe((function(i){t.modalService.toast("Transaction saved!"),t.dialogRef.close(i),t.savingTransaction=!1}),(function(i){t.modalService.swal({title:"Saving Transaction Failed",text:"Unknown Error Occured",icon:"error"}),t.savingTransaction=!1})))}))},t.prototype.setPrice=function(t){2==t.type?(t.paper_size_id=null,t.print_quality_id=null,console.log(this.service_rates.filter((function(t){return t.is_scanning}))),t.price=this.service_rates.filter((function(t){return t.is_scanning}))[0].rate):(t.paper_size_id&&(t.paper_size=this.paper_sizes.filter((function(i){return i.id==t.paper_size_id}))[0]),t.print_quality_id&&(t.print_quality=this.print_qualities.filter((function(i){return i.id==t.print_quality_id}))[0]),t.paper_size_id&&t.print_quality_id&&(t.price=this.service_rates.filter((function(i){return i.is_printing&&i.paper_size_id==t.paper_size_id&&i.print_quality_id==t.print_quality_id}))[0].rate))},t.\u0275fac=function(i){return new(i||t)(u.Qb(a.g),u.Qb(m.a),u.Qb(p),u.Qb(a.a))},t.\u0275cmp=u.Kb({type:t,selectors:[["app-create-transaction"]],viewQuery:function(t,i){var e;1&t&&u.Pc(V,!0),2&t&&u.zc(e=u.jc())&&(i.cancelButton=e.first)},decls:56,vars:15,consts:[["mat-dialog-title",""],[1,"fa","fa-print"],[1,"mat-typography"],[1,"row"],[1,"col-lg-3"],[1,"full-width"],[3,"ngModel","disabled","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["matInput","","disabled","",3,"ngModel","ngModelChange"],[1,"p-1","bg-primary"],[1,"col-lg-12"],["mat-table","",1,"full-width",3,"dataSource"],["matColumnDef","type"],["mat-header-cell","","style","width: 20%;",4,"matHeaderCellDef"],["mat-cell","","class","pr-3",4,"matCellDef"],["matColumnDef","size"],["matColumnDef","quality"],["mat-cell","","class","p-2",4,"matCellDef"],["matColumnDef","quantity"],["mat-cell","","class","text-center",4,"matCellDef"],["matColumnDef","price"],["mat-header-cell","","style","width: 20%;","class","text-center",4,"matHeaderCellDef"],["matColumnDef","total",2,"width","10%"],["mat-header-cell","","class","text-center",4,"matHeaderCellDef"],["matColumnDef","action"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["align","end"],["mat-raised-button","",3,"disabled","click",4,"ngIf"],["mat-raised-button","",3,"disabled","click"],["mat-button","","mat-dialog-close","",3,"disabled"],[3,"value"],["mat-header-cell","",2,"width","20%"],["mat-cell","",1,"pr-3"],[4,"ngIf"],["aria-placeholder","Size",3,"ngModel","ngModelChange","selectionChange"],["aria-placeholder","Size",3,"disabled","ngModel","ngModelChange","selectionChange"],["mat-cell","",1,"p-2"],["aria-placeholder","Quality",3,"disabled","ngModel","ngModelChange","selectionChange"],["mat-cell","",1,"text-center"],["matInput","","type","number","autocomplete","off","min","1",1,"text-center",3,"ngModel","ngModelChange"],["mat-header-cell","",1,"text-center",2,"width","20%"],["mat-header-cell","",1,"text-center"],["mat-header-cell",""],["mat-cell",""],["mat-raised-button","","color","error",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","error",3,"disabled","click"],["mat-header-row",""],["mat-row",""],[1,"fa","fa-plus"]],template:function(t,i){1&t&&(u.Wb(0,"h2",0),u.Rb(1,"i",1),u.Kc(2," New Print Transaction"),u.Vb(),u.Wb(3,"mat-dialog-content",2),u.Wb(4,"div",3),u.Wb(5,"div",4),u.Wb(6,"mat-form-field",5),u.Wb(7,"mat-label"),u.Kc(8,"Member"),u.Vb(),u.Wb(9,"mat-select",6),u.ic("ngModelChange",(function(t){return i.transaction.member_id=t})),u.Ic(10,W,2,2,"mat-option",7),u.Vb(),u.Vb(),u.Vb(),u.Wb(11,"div",4),u.Wb(12,"mat-form-field",5),u.Wb(13,"mat-label"),u.Kc(14,"Transacttion Time"),u.Vb(),u.Wb(15,"input",8),u.ic("ngModelChange",(function(t){return i.transaction.time=t})),u.Vb(),u.Vb(),u.Vb(),u.Wb(16,"div",4),u.Wb(17,"h2",9),u.Kc(18),u.nc(19,"currency"),u.Vb(),u.Vb(),u.Vb(),u.Wb(20,"div",3),u.Wb(21,"div",10),u.Wb(22,"table",11),u.Ub(23,12),u.Ic(24,S,2,0,"th",13),u.Ic(25,K,3,2,"td",14),u.Tb(),u.Ub(26,15),u.Ic(27,q,2,0,"th",13),u.Ic(28,k,3,2,"td",14),u.Tb(),u.Ub(29,16),u.Ic(30,R,2,0,"th",13),u.Ic(31,x,3,2,"td",17),u.Tb(),u.Ub(32,18),u.Ic(33,P,2,0,"th",13),u.Ic(34,B,2,1,"td",19),u.Tb(),u.Ub(35,20),u.Ic(36,U,2,0,"th",21),u.Ic(37,A,2,1,"td",19),u.Tb(),u.Ub(38,22),u.Ic(39,H,2,0,"th",23),u.Ic(40,N,2,1,"td",19),u.Tb(),u.Ub(41,24),u.Ic(42,J,1,0,"th",25),u.Ic(43,Z,2,1,"td",26),u.Tb(),u.Ic(44,tt,1,0,"tr",27),u.Ic(45,it,1,0,"tr",28),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Wb(46,"mat-dialog-actions",29),u.Ic(47,et,2,1,"button",30),u.Wb(48,"button",31),u.ic("click",(function(t){return i.saveTransaction()})),u.Wb(49,"mat-icon"),u.Kc(50,"save"),u.Vb(),u.Kc(51),u.Vb(),u.Wb(52,"button",32),u.Wb(53,"mat-icon"),u.Kc(54,"remove"),u.Vb(),u.Kc(55," Cancel"),u.Vb(),u.Vb()),2&t&&(u.Cb(9),u.sc("ngModel",i.transaction.member_id)("disabled",!0),u.Cb(1),u.sc("ngForOf",i.members),u.Cb(5),u.sc("ngModel",i.transaction.time),u.Cb(3),u.Mc("Total: ",u.pc(19,12,i.transaction.sales," "),""),u.Cb(4),u.sc("dataSource",i.mds),u.Cb(22),u.sc("matHeaderRowDef",i.transactionItemTableColumns),u.Cb(1),u.sc("matRowDefColumns",i.transactionItemTableColumns),u.Cb(2),u.sc("ngIf",null==i.currentTransactionItem||i.currentTransactionItem.is_ready&&0==i.currentTransactionItem.valid),u.Cb(1),u.sc("disabled",!i.currentTransactionItem.is_ready&&1==i.transaction.transaction_items.length||i.savingTransaction),u.Cb(3),u.Mc(" ",i.savingTransaction?"Saving Transaction...":"Save Transaction"," "),u.Cb(1),u.sc("disabled",i.savingTransaction))},directives:[a.h,a.e,h.b,h.e,v.a,g.k,g.n,n.l,_.a,g.b,s.j,s.c,s.e,s.b,s.g,s.i,a.c,n.m,y.b,I.a,a.d,C.h,s.d,s.a,g.p,s.f,s.h],pipes:[n.d],styles:[""]}),t}(),at=e("SWMs"),ct=e("DUip"),st=function(t){function i(i){var e=t.call(this,i,"stations")||this;return e.http=i,e}return Object(r.b)(i,t),i.prototype.use=function(t,i){return this.http.put(this.uri+"/"+t.id,{use:1,password:i})},i.prototype.leave=function(t,i){return this.http.put(this.uri+"/"+t.id,{leave:1,password:i})},i.\u0275fac=function(t){return new(t||i)(u.ec(f.b))},i.\u0275prov=u.Mb({token:i,factory:i.\u0275fac,providedIn:"root"}),i}(d.a),rt=e("l5Kb"),ot=e("iPKQ"),lt=e("0gkb"),bt=e("o9IV"),ut=e("chSY"),mt=e("17Os"),dt=e("eJds"),ft=e("H6It"),pt=e("/RhQ");function ht(t,i){if(1&t){var e=u.Xb();u.Wb(0,"button",7),u.ic("click",(function(t){return u.Bc(e),u.mc(2).newTransaction()})),u.Kc(1,"New Transaction "),u.Vb()}if(2&t){var n=u.mc(2);u.sc("disabled",!n.paper_sizes||!n.print_qualities||!n.service_rates)}}function vt(t,i){1&t&&u.Rb(0,"app-ellipis-loading")}function gt(t,i){1&t&&(u.Wb(0,"th",17),u.Kc(1,"Time"),u.Vb())}function _t(t,i){if(1&t&&(u.Wb(0,"td",18),u.Kc(1),u.nc(2,"dfnsFormat"),u.nc(3,"parseDate"),u.Vb()),2&t){var e=i.$implicit;u.Cb(1),u.Mc(" ",u.pc(2,1,u.oc(3,4,e.time),"hh:mm A MMM DD, YYYY")," ")}}function yt(t,i){1&t&&(u.Wb(0,"th",17),u.Kc(1,"Member"),u.Vb())}function It(t,i){if(1&t&&(u.Wb(0,"td",18),u.Kc(1),u.Vb()),2&t){var e=i.$implicit;u.Cb(1),u.Mc(" ",e.member.fullname," ")}}function Ct(t,i){1&t&&(u.Wb(0,"th",17),u.Kc(1,"Sales"),u.Vb())}function Vt(t,i){if(1&t&&(u.Wb(0,"td",19),u.Kc(1),u.nc(2,"currency"),u.Vb()),2&t){var e=i.$implicit;u.Cb(1),u.Mc(" ",u.pc(2,1,e.sales," ")," ")}}function Wt(t,i){1&t&&u.Rb(0,"tr",20)}function St(t,i){1&t&&u.Rb(0,"tr",21)}function wt(t,i){if(1&t&&(u.Wb(0,"table",8),u.Ub(1,9),u.Ic(2,gt,2,0,"th",10),u.Ic(3,_t,4,6,"td",11),u.Tb(),u.Ub(4,12),u.Ic(5,yt,2,0,"th",10),u.Ic(6,It,2,1,"td",11),u.Tb(),u.Ub(7,13),u.Ic(8,Ct,2,0,"th",10),u.Ic(9,Vt,3,4,"td",14),u.Tb(),u.Ic(10,Wt,1,0,"tr",15),u.Ic(11,St,1,0,"tr",16),u.Vb()),2&t){var e=u.mc(2);u.sc("dataSource",e.mds),u.Cb(10),u.sc("matHeaderRowDef",e.transactionTableColumns),u.Cb(1),u.sc("matRowDefColumns",e.transactionTableColumns)}}function Tt(t,i){if(1&t&&(u.Wb(0,"span"),u.Kc(1),u.Rb(2,"br"),u.Vb()),2&t){var e=u.mc(2);u.Cb(1),u.Mc("Current user is ",e.station.current_session.user.fullname," ")}}function Dt(t,i){if(1&t&&(u.Wb(0,"h1"),u.Kc(1),u.nc(2,"currency"),u.Wb(3,"small"),u.Kc(4,"Total Sales"),u.Vb(),u.Vb()),2&t){var e=u.mc(2);u.Cb(1),u.Mc("",u.pc(2,1,e.sales," ")," ")}}function Kt(t,i){if(1&t){var e=u.Xb();u.Wb(0,"button",22),u.ic("click",(function(t){return u.Bc(e),u.mc(2).leaveSession()})),u.Wb(1,"mat-icon"),u.Kc(2,"exit_to_app"),u.Vb(),u.Kc(3),u.Vb()}if(2&t){var n=u.mc(2);u.sc("disabled",n.isLeaving),u.Cb(3),u.Mc(" ",n.isLeaving?"Leaving Session...":"Leave Session","")}}function qt(t,i){if(1&t&&(u.Wb(0,"div"),u.Wb(1,"div",1),u.Wb(2,"div",2),u.Wb(3,"mat-card"),u.Wb(4,"mat-card-header"),u.Wb(5,"mat-card-title"),u.Kc(6),u.Vb(),u.Wb(7,"mat-card-subtitle"),u.Rb(8,"br"),u.Ic(9,ht,2,1,"button",3),u.Vb(),u.Vb(),u.Wb(10,"mat-card-content"),u.Ic(11,vt,1,0,"app-ellipis-loading",0),u.Ic(12,wt,12,3,"table",4),u.Vb(),u.Vb(),u.Vb(),u.Wb(13,"div",5),u.Wb(14,"mat-card"),u.Wb(15,"mat-card-header"),u.Wb(16,"mat-card-title"),u.Kc(17,"Session Summary"),u.Vb(),u.Vb(),u.Wb(18,"mat-card-content"),u.Ic(19,Tt,3,1,"span",0),u.Kc(20),u.nc(21,"dfnsDistanceInWordsToNow"),u.nc(22,"parseDate"),u.Rb(23,"br"),u.Rb(24,"br"),u.Ic(25,Dt,5,4,"h1",0),u.Rb(26,"br"),u.Rb(27,"br"),u.Ic(28,Kt,4,2,"button",6),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Vb()),2&t){var e=u.mc();u.Cb(6),u.Mc("Transactions on ",e.station.description," "),u.Cb(3),u.sc("ngIf",e.isOnDuty),u.Cb(2),u.sc("ngIf",e.isLoadingTransactions),u.Cb(1),u.sc("ngIf",0==e.isLoadingTransactions),u.Cb(7),u.sc("ngIf",0==e.isOnDuty),u.Cb(1),u.Mc(" Started ",u.oc(21,8,u.oc(22,10,e.station.current_session.time_in))," ago "),u.Cb(5),u.sc("ngIf",!e.isLoadingTransactions),u.Cb(3),u.sc("ngIf",e.isOnDuty)}}function Mt(t,i){1&t&&u.Rb(0,"app-ellipis-loading")}var zt=function(){function t(t,i,e,n,a,c,r,o,l,b,u){this.activatedRoute=t,this.stationService=i,this.modalService=e,this.stateService=n,this.router=a,this.authService=c,this.paperSizeService=r,this.printQualityService=o,this.serviceRateService=l,this.serviceTransacrionService=b,this.dialog=u,this.station=null,this.isLeaving=!1,this.isOnDuty=!1,this.paper_sizes=[],this.print_qualities=[],this.service_rates=[],this.transactionTableColumns=["time","member","sales"],this.sales=0,this.isLoadingTransactions=!0,this.transactions=[],this.mds=new s.k}return t.prototype.ngOnInit=function(){var t=this;this.station=this.stateService.get("active_station"),null==this.station?this.stationService.read(this.activatedRoute.snapshot.params.station).subscribe((function(i){i.current_session?(t.station=i,t.isOnDuty=t.authService.user.id==t.station.current_session.user_id,t.isOnDuty&&t.stateService.set("active_station",i),t.fetchTransactions()):t.router.navigate(["/service-transactions"])}),(function(i){t.modalService.toast("Error reading station"),t.router.navigate(["/service-transactions"])})):(this.isOnDuty=this.authService.user.id==this.station.current_session.user_id,this.fetchTransactions()),this.fetchConfig()},t.prototype.fetchConfig=function(){var t=this;this.paper_sizes=this.stateService.get("paper_sizes"),this.print_qualities=this.stateService.get("print_qualities"),this.service_rates=this.stateService.get("service_rates"),null==this.paper_sizes&&this.paperSizeService.query().subscribe((function(i){t.paper_sizes=i,t.stateService.set("paper_sizes",i)})),null==this.print_qualities&&this.printQualityService.query().subscribe((function(i){t.print_qualities=i,t.stateService.set("print_qualities",i)})),null==this.service_rates&&this.serviceRateService.query().subscribe((function(i){t.service_rates=i.map((function(t){return(new at.a).fill(t)})),t.stateService.set("service_rates",t.service_rates)}))},t.prototype.leaveSession=function(){var t=this;this.modalService.prompt({question:"Please enter your password to continue",required:!0,password:!0}).then((function(i){i&&(t.isLeaving=!0,t.stationService.leave(t.station,i).subscribe((function(i){t.stateService.set("active_station",null),t.modalService.toast("You leaved the session","Session leaved"),t.router.navigate(["/service-transactions"]),t.isLeaving=!1}),(function(i){"Password is incorrect"==i.error.message?t.modalService.swal({text:"Incorrect password",title:"Oops!",icon:"error"}):t.modalService.toast("Something went wrong","Oops!","error"),t.isLeaving=!1})))}))},t.prototype.newTransaction=function(){var t=this;this.dialog.open(nt,{width:"90%",disableClose:!0,data:{station:this.station,paper_sizes:this.paper_sizes,print_qualities:this.print_qualities,service_rates:this.service_rates}}).afterClosed().subscribe((function(i){i&&(t.transactions.unshift(i),t.mds.connect().next(t.transactions),t.sales+=Number(i.sales))}))},t.prototype.fetchTransactions=function(){var t=this;this.isLoadingTransactions=!0,this.serviceTransacrionService.query({params:{time:this.station.current_session.time_in,station_id:this.station.id}}).subscribe((function(i){t.transactions=i,t.mds.connect().next(t.transactions),t.isLoadingTransactions=!1,t.sales=0,t.transactions.forEach((function(i){t.sales+=Number(i.sales)}))}))},t.\u0275fac=function(i){return new(i||t)(u.Qb(ct.a),u.Qb(st),u.Qb(m.a),u.Qb(rt.a),u.Qb(ct.g),u.Qb(ot.a),u.Qb(lt.a),u.Qb(bt.a),u.Qb(ut.a),u.Qb(p),u.Qb(a.b))},t.\u0275cmp=u.Kb({type:t,selectors:[["app-show"]],decls:2,vars:2,consts:[[4,"ngIf"],[1,"row"],[1,"col-lg-8"],["mat-raised-button","","color","primary",3,"disabled","click",4,"ngIf"],["mat-table","","class","full-width",3,"dataSource",4,"ngIf"],[1,"col-lg-4"],["mat-raised-button","","color","warn",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","primary",3,"disabled","click"],["mat-table","",1,"full-width",3,"dataSource"],["matColumnDef","time"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","member"],["matColumnDef","sales"],["mat-cell","","class","text-right pr-2",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-cell","",1,"text-right","pr-2"],["mat-header-row",""],["mat-row",""],["mat-raised-button","","color","warn",3,"disabled","click"]],template:function(t,i){1&t&&(u.Ic(0,qt,29,12,"div",0),u.Ic(1,Mt,1,0,"app-ellipis-loading",0)),2&t&&(u.sc("ngIf",i.station&&null!=i.station.current_session),u.Cb(1),u.sc("ngIf",null==i.station))},directives:[n.m,mt.a,mt.d,mt.g,mt.f,mt.c,y.b,dt.a,s.j,s.c,s.e,s.b,s.g,s.i,s.d,s.a,s.f,s.h,I.a],pipes:[ft.c,pt.a,ft.d,n.d],styles:[""]}),t}();function $t(t,i){if(1&t&&(u.Wb(0,"div"),u.Kc(1," Logged User: "),u.Wb(2,"span",5),u.Kc(3),u.Vb(),u.Rb(4,"br"),u.Rb(5,"br"),u.Wb(6,"a",6),u.Kc(7,"View Transactions"),u.Vb(),u.Vb()),2&t){var e=u.mc().$implicit;u.Cb(3),u.Lc(e.current_session.user.fullname),u.Cb(3),u.sc("routerLink","/service-transactions/"+e.id)}}function kt(t,i){if(1&t&&(u.Wb(0,"span"),u.Kc(1),u.nc(2,"dfnsDistanceInWordsToNow"),u.nc(3,"parseDate"),u.Vb()),2&t){var e=u.mc(2).$implicit;u.Cb(1),u.Nc(" Last used by ",e.previous_session.user.firstname," ",u.oc(2,2,u.oc(3,4,e.previous_session.time_out))," ago ")}}function Rt(t,i){if(1&t){var e=u.Xb();u.Wb(0,"div",7),u.Ic(1,kt,4,6,"span",0),u.Rb(2,"br"),u.Rb(3,"br"),u.Wb(4,"button",8),u.ic("click",(function(t){u.Bc(e);var i=u.mc().$implicit;return u.mc(2).useStation(i)})),u.Kc(5),u.Vb(),u.Vb()}if(2&t){var n=u.mc().$implicit;u.Cb(1),u.sc("ngIf",n.previous_session),u.Cb(3),u.sc("disabled",n.isJoining||0==n.allowed_to_use),u.Cb(1),u.Lc(n.isJoining?"Loading...":"Use")}}function Ot(t,i){if(1&t&&(u.Wb(0,"div",3),u.Wb(1,"mat-card"),u.Wb(2,"mat-card-header"),u.Wb(3,"mat-card-title-group"),u.Wb(4,"mat-card-title"),u.Wb(5,"mat-icon"),u.Kc(6,"desktop_windows"),u.Vb(),u.Kc(7),u.Vb(),u.Vb(),u.Vb(),u.Wb(8,"mat-card-content"),u.Ic(9,$t,8,2,"div",0),u.Ic(10,Rt,6,3,"div",4),u.Vb(),u.Vb(),u.Vb()),2&t){var e=i.$implicit;u.Cb(7),u.Mc(" ",e.description," "),u.Cb(2),u.sc("ngIf",e.current_session),u.Cb(1),u.sc("ngIf",null==e.current_session)}}function Lt(t,i){if(1&t&&(u.Wb(0,"div"),u.Wb(1,"h1"),u.Kc(2,"Choose Station"),u.Vb(),u.Wb(3,"div",1),u.Ic(4,Ot,11,3,"div",2),u.Vb(),u.Vb()),2&t){var e=u.mc();u.Cb(4),u.sc("ngForOf",e.stations)}}function Qt(t,i){1&t&&(u.Wb(0,"h1"),u.Kc(1,"Loading Stations..."),u.Vb())}var xt=[{path:"",component:function(){function t(t,i,e,n,a){this.stationService=t,this.authService=i,this.router=e,this.stateService=n,this.modalService=a,this.fetchingStations=!1}return t.prototype.ngOnInit=function(){var t=this.stateService.get("active_station");t?this.setActiveStation(t):this.fetchStations()},t.prototype.fetchStations=function(){var t=this;this.fetchingStations=!0,this.stationService.query().subscribe((function(i){var e=null;i.forEach((function(i){i.current_session&&i.current_session.user_id==t.authService.user.id&&(e=i)})),null==e?t.stations=i:t.setActiveStation(e),t.fetchingStations=!1}))},t.prototype.useStation=function(t){var i=this;this.modalService.prompt({question:"Please enter your password to continue",required:!0,password:!0}).then((function(e){e&&(t.isJoining=!0,i.stationService.use(t,e).subscribe((function(t){t.isJoining=!1,i.setActiveStation(t)}),(function(e){t.isJoining=!1,i.modalService.alert({message:"Password is not correct",type:"warn"})})))}))},t.prototype.setActiveStation=function(t){this.stateService.set("active_station",t),this.router.navigate(["/service-transactions/"+t.id])},t.\u0275fac=function(i){return new(i||t)(u.Qb(st),u.Qb(ot.a),u.Qb(ct.g),u.Qb(rt.a),u.Qb(m.a))},t.\u0275cmp=u.Kb({type:t,selectors:[["app-index"]],decls:2,vars:2,consts:[[4,"ngIf"],[1,"row"],["class","col-lg-3",4,"ngFor","ngForOf"],[1,"col-lg-3"],["class","text-muted",4,"ngIf"],[1,"text-primary"],["mat-raised-button","","color","primary",3,"routerLink"],[1,"text-muted"],["mat-raised-button","","color","primary",3,"disabled","click"]],template:function(t,i){1&t&&(u.Ic(0,Lt,5,1,"div",0),u.Ic(1,Qt,2,0,"h1",0)),2&t&&(u.sc("ngIf",i.stations),u.Cb(1),u.sc("ngIf",i.fetchingStations))},directives:[n.m,n.l,mt.a,mt.d,mt.h,mt.g,I.a,mt.c,y.a,ct.j,y.b],pipes:[ft.c,pt.a],styles:[""]}),t}()},{path:":station",component:zt}],Pt=function(){function t(){}return t.\u0275mod=u.Ob({type:t}),t.\u0275inj=u.Nb({factory:function(i){return new(i||t)},imports:[[ct.k.forChild(xt)],ct.k]}),t}(),jt=e("FpXt");e.d(i,"ServiceTransactionsModule",(function(){return Bt}));var Bt=function(){function t(){}return t.\u0275mod=u.Ob({type:t}),t.\u0275inj=u.Nb({factory:function(i){return new(i||t)},imports:[[n.c,Pt,jt.a]]}),t}()}}]);