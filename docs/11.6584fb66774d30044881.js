(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{ImkO:function(t,i,n){"use strict";n.r(i);var e=n("Valr"),a=n("ea4N"),c=n("cPJV"),r=n("ETwC"),s=n("mrSG"),o=n("gSfl"),l=function(t){function i(){var i=t.call(this)||this;return i.sales=0,i}return Object(s.b)(i,t),i.prototype.computeSales=function(){var t=this;this.transaction_items&&(this.sales=0,this.transaction_items.forEach((function(i){t.sales+=i.total})))},i}(o.a),b=function(t){function i(){var i=t.call(this)||this;return i.reset(),i}return Object(s.b)(i,t),i.prototype.markAsValid=function(){this._valid=!0},Object.defineProperty(i.prototype,"valid",{get:function(){return this._valid},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"is_ready",{get:function(){return 1==this.type&&null!=this.paper_size_id&&null!=this.print_quality_id||2==this.type},enumerable:!0,configurable:!0}),i.prototype.reset=function(){this._valid=!1,this.type=1,this.paper_size_id=null,this.print_quality_id=null,this.quantity=1,this.price=0,this.total=0},Object.defineProperty(i.prototype,"is_printing",{get:function(){return 1==this.type},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"is_scanning",{get:function(){return 2==this.type},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"type_label",{get:function(){return 1==this.type?"Print":"Scan"},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"computed_total",{get:function(){return this.quantity*this.price},enumerable:!0,configurable:!0}),i}(o.a),u=n("TYT/"),d=n("WHFS"),f=n("fB3y"),p=n("cUzu"),m=function(t){function i(i){return t.call(this,i,"service-transactions")||this}return Object(s.b)(i,t),i.\u0275fac=function(t){return new(t||i)(u.fc(p.b))},i.\u0275prov=u.Nb({token:i,factory:i.\u0275fac,providedIn:"root"}),i}(f.a),h=n("eHTH"),v=n("agxM"),g=n("QJY3"),_=n("cSbt"),y=n("p+mS"),D=n("GsDI"),S=n("MqYC"),W=["cancelButton"];function X(t,i){if(1&t&&(u.Xb(0,"mat-option",33),u.Lc(1),u.Wb()),2&t){var n=i.$implicit;u.tc("value",n.id),u.Db(1),u.Nc(" ",n.fullname," ")}}function w(t,i){1&t&&(u.Xb(0,"th",34),u.Lc(1," Type "),u.Wb())}function I(t,i){if(1&t&&(u.Xb(0,"span"),u.Lc(1),u.Wb()),2&t){var n=u.nc().$implicit;u.Db(1),u.Mc(n.type_label)}}function L(t,i){if(1&t&&(u.Xb(0,"mat-option",33),u.Lc(1),u.Wb()),2&t){var n=i.$implicit;u.tc("value",n.key),u.Db(1),u.Mc(n.value)}}function T(t,i){if(1&t){var n=u.Yb();u.Xb(0,"mat-form-field"),u.Xb(1,"mat-select",37),u.jc("ngModelChange",(function(t){return u.Cc(n),u.nc().$implicit.type=t}))("selectionChange",(function(t){u.Cc(n);var i=u.nc().$implicit;return u.nc().setPrice(i)})),u.Jc(2,L,2,2,"mat-option",7),u.Wb(),u.Wb()}if(2&t){var e=u.nc().$implicit,a=u.nc();u.Db(1),u.tc("ngModel",e.type),u.Db(1),u.tc("ngForOf",a.station.service_types)}}function C(t,i){if(1&t&&(u.Xb(0,"td",35),u.Jc(1,I,2,1,"span",36),u.Jc(2,T,3,2,"mat-form-field",36),u.Wb()),2&t){var n=i.$implicit;u.Db(1),u.tc("ngIf",n.valid),u.Db(1),u.tc("ngIf",!n.valid)}}function J(t,i){1&t&&(u.Xb(0,"th",34),u.Lc(1," Size "),u.Wb())}function q(t,i){if(1&t&&(u.Xb(0,"span"),u.Lc(1),u.Wb()),2&t){var n=u.nc().$implicit;u.Db(1),u.Mc(n.is_scanning?"N/A":n.paper_size.description)}}function M(t,i){if(1&t&&(u.Xb(0,"mat-option",33),u.Lc(1),u.Wb()),2&t){var n=i.$implicit;u.tc("value",n.id),u.Db(1),u.Mc(n.description)}}function k(t,i){if(1&t){var n=u.Yb();u.Xb(0,"mat-form-field"),u.Xb(1,"mat-select",38),u.jc("ngModelChange",(function(t){return u.Cc(n),u.nc().$implicit.paper_size_id=t}))("selectionChange",(function(t){u.Cc(n);var i=u.nc().$implicit;return u.nc().setPrice(i)})),u.Jc(2,M,2,2,"mat-option",7),u.Wb(),u.Wb()}if(2&t){var e=u.nc().$implicit,a=u.nc();u.Db(1),u.tc("disabled",e.is_scanning)("ngModel",e.paper_size_id),u.Db(1),u.tc("ngForOf",a.paper_sizes)}}function z(t,i){if(1&t&&(u.Xb(0,"td",35),u.Jc(1,q,2,1,"span",36),u.Jc(2,k,3,3,"mat-form-field",36),u.Wb()),2&t){var n=i.$implicit;u.Db(1),u.tc("ngIf",n.valid),u.Db(1),u.tc("ngIf",!n.valid)}}function R(t,i){1&t&&(u.Xb(0,"th",34),u.Lc(1," Quality "),u.Wb())}function $(t,i){if(1&t&&(u.Xb(0,"span"),u.Lc(1),u.Wb()),2&t){var n=u.nc().$implicit;u.Db(1),u.Mc(n.is_scanning?"N/A":n.print_quality.description)}}function O(t,i){if(1&t&&(u.Xb(0,"mat-option",33),u.Lc(1),u.Wb()),2&t){var n=i.$implicit;u.tc("value",n.id),u.Db(1),u.Mc(n.description)}}function j(t,i){if(1&t){var n=u.Yb();u.Xb(0,"mat-form-field"),u.Xb(1,"mat-select",40),u.jc("ngModelChange",(function(t){return u.Cc(n),u.nc().$implicit.print_quality_id=t}))("selectionChange",(function(t){u.Cc(n);var i=u.nc().$implicit;return u.nc().setPrice(i)})),u.Jc(2,O,2,2,"mat-option",7),u.Wb(),u.Wb()}if(2&t){var e=u.nc().$implicit,a=u.nc();u.Db(1),u.tc("disabled",e.is_scanning)("ngModel",e.print_quality_id),u.Db(1),u.tc("ngForOf",a.print_qualities)}}function N(t,i){if(1&t&&(u.Xb(0,"td",39),u.Jc(1,$,2,1,"span",36),u.Jc(2,j,3,3,"mat-form-field",36),u.Wb()),2&t){var n=i.$implicit;u.Db(1),u.tc("ngIf",n.valid),u.Db(1),u.tc("ngIf",!n.valid)}}function Y(t,i){1&t&&(u.Xb(0,"th",34),u.Lc(1," Quantity "),u.Wb())}function x(t,i){if(1&t){var n=u.Yb();u.Xb(0,"mat-form-field"),u.Xb(1,"input",42),u.jc("ngModelChange",(function(t){return u.Cc(n),u.nc().$implicit.quantity=t})),u.Wb(),u.Wb()}if(2&t){var e=u.nc().$implicit;u.Db(1),u.tc("ngModel",e.quantity)}}function P(t,i){if(1&t&&(u.Xb(0,"td",41),u.Jc(1,x,2,1,"mat-form-field",36),u.Wb()),2&t){var n=i.$implicit;u.Db(1),u.tc("ngIf",n.is_ready)}}function V(t,i){1&t&&(u.Xb(0,"th",43),u.Lc(1," Price "),u.Wb())}function U(t,i){if(1&t&&(u.Xb(0,"span"),u.Lc(1),u.Wb()),2&t){var n=u.nc().$implicit;u.Db(1),u.Mc(n.price)}}function A(t,i){if(1&t&&(u.Xb(0,"td",41),u.Jc(1,U,2,1,"span",36),u.Wb()),2&t){var n=i.$implicit;u.Db(1),u.tc("ngIf",n.is_ready)}}function F(t,i){1&t&&(u.Xb(0,"th",44),u.Lc(1," Amount "),u.Wb())}function H(t,i){if(1&t&&(u.Xb(0,"span"),u.Lc(1),u.Wb()),2&t){var n=u.nc().$implicit;u.Db(1),u.Mc(n.computed_total)}}function Q(t,i){if(1&t&&(u.Xb(0,"td",41),u.Jc(1,H,2,1,"span",36),u.Wb()),2&t){var n=i.$implicit;u.Db(1),u.tc("ngIf",n.is_ready)}}function E(t,i){1&t&&u.Sb(0,"th",45)}function B(t,i){1&t&&(u.Xb(0,"mat-icon"),u.Lc(1,"remove"),u.Wb())}function G(t,i){1&t&&(u.Xb(0,"mat-icon"),u.Lc(1,"refresh"),u.Wb())}function K(t,i){if(1&t){var n=u.Yb();u.Xb(0,"button",48),u.jc("click",(function(t){u.Cc(n);var i=u.nc().$implicit;return u.nc().removeItem(i)})),u.Jc(1,B,2,0,"mat-icon",36),u.Jc(2,G,2,0,"mat-icon",36),u.Wb()}if(2&t){var e=u.nc().$implicit,a=u.nc();u.tc("disabled",a.savingTransaction),u.Db(1),u.tc("ngIf",e.valid),u.Db(1),u.tc("ngIf",e.dirty&&a.transaction.transaction_items.length>1)}}function Z(t,i){if(1&t&&(u.Xb(0,"td",46),u.Jc(1,K,3,3,"button",47),u.Wb()),2&t){var n=i.$implicit,e=u.nc();u.Db(1),u.tc("ngIf",n.valid||e.transaction.transaction_items.length>1)}}function tt(t,i){1&t&&u.Sb(0,"tr",49)}function it(t,i){1&t&&u.Sb(0,"tr",50)}function nt(t,i){if(1&t){var n=u.Yb();u.Xb(0,"button",31),u.jc("click",(function(t){return u.Cc(n),u.nc().addItem()})),u.Sb(1,"i",51),u.Wb()}if(2&t){var e=u.nc();u.tc("disabled",e.savingTransaction)}}var et=function(){function t(t,i,n,e){this.dialogRef=t,this.modalService=i,this.serviceTransactionService=n,this.matData=e,this.members=[{id:"1",fullname:"Anonymous"}],this.transactionItemTableColumns=["type","size","quality","quantity","price","total","action"],this.savingTransaction=!1,this.service_rates=[],this.transaction=new l,this.transaction.member_id="1",this.transaction.timeFormatted=c(new Date,"MMM DD, YYYY hh:mm A"),this.currentTransactionItem=new b,this.transaction.transaction_items=[this.currentTransactionItem],this.mds=new r.k(this.transaction.transaction_items),this.station=this.matData.station,this.paper_sizes=this.matData.paper_sizes,this.print_qualities=this.matData.print_qualities,this.service_rates=this.matData.service_rates}return t.prototype.ngOnInit=function(){},t.prototype.ngAfterViewInit=function(){},t.prototype.addItem=function(){this.currentTransactionItem.is_ready&&(this.checkDuplicates()||(this.currentTransactionItem.markAsValid(),this.currentTransactionItem=new b,this.transaction.transaction_items.push(this.currentTransactionItem)),this.mds.connect().next(this.transaction.transaction_items),this.transaction.computeSales())},t.prototype.checkDuplicates=function(){var t=this,i=!1;return this.transaction.transaction_items.forEach((function(n,e){!i&&t.currentTransactionItem.is_printing&&n.valid&&n.paper_size_id===t.currentTransactionItem.paper_size_id&&n.print_quality_id===t.currentTransactionItem.print_quality_id&&(i=!0,n.quantity+=t.currentTransactionItem.quantity,t.currentTransactionItem.reset()),!i&&t.currentTransactionItem.is_scanning&&n.is_scanning&&n.valid&&(i=!0,n.quantity+=t.currentTransactionItem.quantity,t.currentTransactionItem.reset())})),i},t.prototype.removeItem=function(t){t.valid&&(this.transaction.transaction_items=this.transaction.transaction_items.filter((function(i){return!(i.type==t.type&&i.paper_size_id==t.paper_size_id&&i.print_quality_id==t.print_quality_id&&i.valid)}))),this.mds.connect().next(this.transaction.transaction_items)},t.prototype.saveTransaction=function(){var t=this;this.modalService.confirm({message:"Save this transaction?"}).then((function(i){i&&(t.checkDuplicates(),t.currentTransactionItem.is_ready&&t.addItem(),t.transaction.transaction_items=t.transaction.transaction_items.filter((function(t){return t.valid})),t.transaction.station_id=t.station.id,t.savingTransaction=!0,t.serviceTransactionService.create(t.transaction).subscribe((function(i){t.modalService.toast("Transaction saved!"),t.dialogRef.close(i),t.savingTransaction=!1}),(function(i){t.modalService.swal({title:"Saving Transaction Failed",text:"Unknown Error Occured",icon:"error"}),t.savingTransaction=!1})))}))},t.prototype.setPrice=function(t){2==t.type?(t.paper_size_id=null,t.print_quality_id=null,console.log(this.service_rates.filter((function(t){return t.is_scanning}))),t.price=this.service_rates.filter((function(t){return t.is_scanning}))[0].rate):(t.paper_size_id&&(t.paper_size=this.paper_sizes.filter((function(i){return i.id==t.paper_size_id}))[0]),t.print_quality_id&&(t.print_quality=this.print_qualities.filter((function(i){return i.id==t.print_quality_id}))[0]),t.paper_size_id&&t.print_quality_id&&(t.price=this.service_rates.filter((function(i){return i.is_printing&&i.paper_size_id==t.paper_size_id&&i.print_quality_id==t.print_quality_id}))[0].rate))},t.\u0275fac=function(i){return new(i||t)(u.Rb(a.g),u.Rb(d.a),u.Rb(m),u.Rb(a.a))},t.\u0275cmp=u.Lb({type:t,selectors:[["app-create-transaction"]],viewQuery:function(t,i){var n;1&t&&u.Qc(W,!0),2&t&&u.Ac(n=u.kc())&&(i.cancelButton=n.first)},decls:56,vars:15,consts:[["mat-dialog-title",""],[1,"fa","fa-print"],[1,"mat-typography"],[1,"row"],[1,"col-lg-3"],[1,"full-width"],[3,"ngModel","disabled","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["matInput","","disabled","",3,"ngModel","ngModelChange"],[1,"p-1","bg-primary"],[1,"col-lg-12"],["mat-table","",1,"full-width",3,"dataSource"],["matColumnDef","type"],["mat-header-cell","","style","width: 20%;",4,"matHeaderCellDef"],["mat-cell","","class","pr-3",4,"matCellDef"],["matColumnDef","size"],["matColumnDef","quality"],["mat-cell","","class","p-2",4,"matCellDef"],["matColumnDef","quantity"],["mat-cell","","class","text-center",4,"matCellDef"],["matColumnDef","price"],["mat-header-cell","","style","width: 20%;","class","text-center",4,"matHeaderCellDef"],["matColumnDef","total",2,"width","10%"],["mat-header-cell","","class","text-center",4,"matHeaderCellDef"],["matColumnDef","action"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["align","end"],["mat-raised-button","",3,"disabled","click",4,"ngIf"],["mat-raised-button","",3,"disabled","click"],["mat-button","","mat-dialog-close","",3,"disabled"],[3,"value"],["mat-header-cell","",2,"width","20%"],["mat-cell","",1,"pr-3"],[4,"ngIf"],["aria-placeholder","Size",3,"ngModel","ngModelChange","selectionChange"],["aria-placeholder","Size",3,"disabled","ngModel","ngModelChange","selectionChange"],["mat-cell","",1,"p-2"],["aria-placeholder","Quality",3,"disabled","ngModel","ngModelChange","selectionChange"],["mat-cell","",1,"text-center"],["matInput","","type","number","autocomplete","off","min","1",1,"text-center",3,"ngModel","ngModelChange"],["mat-header-cell","",1,"text-center",2,"width","20%"],["mat-header-cell","",1,"text-center"],["mat-header-cell",""],["mat-cell",""],["mat-raised-button","","color","error",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","error",3,"disabled","click"],["mat-header-row",""],["mat-row",""],[1,"fa","fa-plus"]],template:function(t,i){1&t&&(u.Xb(0,"h2",0),u.Sb(1,"i",1),u.Lc(2," New Print Transaction"),u.Wb(),u.Xb(3,"mat-dialog-content",2),u.Xb(4,"div",3),u.Xb(5,"div",4),u.Xb(6,"mat-form-field",5),u.Xb(7,"mat-label"),u.Lc(8,"Member"),u.Wb(),u.Xb(9,"mat-select",6),u.jc("ngModelChange",(function(t){return i.transaction.member_id=t})),u.Jc(10,X,2,2,"mat-option",7),u.Wb(),u.Wb(),u.Wb(),u.Xb(11,"div",4),u.Xb(12,"mat-form-field",5),u.Xb(13,"mat-label"),u.Lc(14,"Transacttion Time"),u.Wb(),u.Xb(15,"input",8),u.jc("ngModelChange",(function(t){return i.transaction.time=t})),u.Wb(),u.Wb(),u.Wb(),u.Xb(16,"div",4),u.Xb(17,"h2",9),u.Lc(18),u.oc(19,"currency"),u.Wb(),u.Wb(),u.Wb(),u.Xb(20,"div",3),u.Xb(21,"div",10),u.Xb(22,"table",11),u.Vb(23,12),u.Jc(24,w,2,0,"th",13),u.Jc(25,C,3,2,"td",14),u.Ub(),u.Vb(26,15),u.Jc(27,J,2,0,"th",13),u.Jc(28,z,3,2,"td",14),u.Ub(),u.Vb(29,16),u.Jc(30,R,2,0,"th",13),u.Jc(31,N,3,2,"td",17),u.Ub(),u.Vb(32,18),u.Jc(33,Y,2,0,"th",13),u.Jc(34,P,2,1,"td",19),u.Ub(),u.Vb(35,20),u.Jc(36,V,2,0,"th",21),u.Jc(37,A,2,1,"td",19),u.Ub(),u.Vb(38,22),u.Jc(39,F,2,0,"th",23),u.Jc(40,Q,2,1,"td",19),u.Ub(),u.Vb(41,24),u.Jc(42,E,1,0,"th",25),u.Jc(43,Z,2,1,"td",26),u.Ub(),u.Jc(44,tt,1,0,"tr",27),u.Jc(45,it,1,0,"tr",28),u.Wb(),u.Wb(),u.Wb(),u.Wb(),u.Xb(46,"mat-dialog-actions",29),u.Jc(47,nt,2,1,"button",30),u.Xb(48,"button",31),u.jc("click",(function(t){return i.saveTransaction()})),u.Xb(49,"mat-icon"),u.Lc(50,"save"),u.Wb(),u.Lc(51),u.Wb(),u.Xb(52,"button",32),u.Xb(53,"mat-icon"),u.Lc(54,"remove"),u.Wb(),u.Lc(55," Cancel"),u.Wb(),u.Wb()),2&t&&(u.Db(9),u.tc("ngModel",i.transaction.member_id)("disabled",!0),u.Db(1),u.tc("ngForOf",i.members),u.Db(5),u.tc("ngModel",i.transaction.time),u.Db(3),u.Nc("Total: ",u.qc(19,12,i.transaction.sales," "),""),u.Db(4),u.tc("dataSource",i.mds),u.Db(22),u.tc("matHeaderRowDef",i.transactionItemTableColumns),u.Db(1),u.tc("matRowDefColumns",i.transactionItemTableColumns),u.Db(2),u.tc("ngIf",null==i.currentTransactionItem||i.currentTransactionItem.is_ready&&0==i.currentTransactionItem.valid),u.Db(1),u.tc("disabled",!i.currentTransactionItem.is_ready&&1==i.transaction.transaction_items.length||i.savingTransaction),u.Db(3),u.Nc(" ",i.savingTransaction?"Saving Transaction...":"Save Transaction"," "),u.Db(1),u.tc("disabled",i.savingTransaction))},directives:[a.h,a.e,h.b,h.e,v.a,g.k,g.n,e.l,_.a,g.b,r.j,r.c,r.e,r.b,r.g,r.i,a.c,e.m,y.b,D.a,a.d,S.h,r.d,r.a,g.p,r.f,r.h],pipes:[e.d],styles:[""]}),t}(),at=n("SWMs"),ct=n("DUip"),rt=function(t){function i(i){var n=t.call(this,i,"stations")||this;return n.http=i,n}return Object(s.b)(i,t),i.prototype.use=function(t,i){return this.http.put(this.uri+"/"+t.id,{use:1,password:i})},i.prototype.leave=function(t,i){return this.http.put(this.uri+"/"+t.id,{leave:1,password:i})},i.\u0275fac=function(t){return new(t||i)(u.fc(p.b))},i.\u0275prov=u.Nb({token:i,factory:i.\u0275fac,providedIn:"root"}),i}(f.a),st=n("l5Kb"),ot=n("iPKQ"),lt=n("0gkb"),bt=n("o9IV"),ut=n("chSY"),dt=n("17Os"),ft=n("eJds"),pt=n("H6It"),mt=n("/RhQ");function ht(t,i){if(1&t){var n=u.Yb();u.Xb(0,"button",7),u.jc("click",(function(t){return u.Cc(n),u.nc(2).newTransaction()})),u.Lc(1,"New Transaction "),u.Wb()}if(2&t){var e=u.nc(2);u.tc("disabled",!e.paper_sizes||!e.print_qualities||!e.service_rates)}}function vt(t,i){1&t&&u.Sb(0,"app-ellipis-loading")}function gt(t,i){1&t&&(u.Xb(0,"th",17),u.Lc(1,"Time"),u.Wb())}function _t(t,i){if(1&t&&(u.Xb(0,"td",18),u.Lc(1),u.oc(2,"dfnsFormat"),u.oc(3,"parseDate"),u.Wb()),2&t){var n=i.$implicit;u.Db(1),u.Nc(" ",u.qc(2,1,u.pc(3,4,n.time),"hh:mm A MMM DD, YYYY")," ")}}function yt(t,i){1&t&&(u.Xb(0,"th",17),u.Lc(1,"Member"),u.Wb())}function Dt(t,i){if(1&t&&(u.Xb(0,"td",18),u.Lc(1),u.Wb()),2&t){var n=i.$implicit;u.Db(1),u.Nc(" ",n.member.fullname," ")}}function St(t,i){1&t&&(u.Xb(0,"th",17),u.Lc(1,"Sales"),u.Wb())}function Wt(t,i){if(1&t&&(u.Xb(0,"td",19),u.Lc(1),u.oc(2,"currency"),u.Wb()),2&t){var n=i.$implicit;u.Db(1),u.Nc(" ",u.qc(2,1,n.sales," ")," ")}}function Xt(t,i){1&t&&u.Sb(0,"tr",20)}function wt(t,i){1&t&&u.Sb(0,"tr",21)}function It(t,i){if(1&t&&(u.Xb(0,"table",8),u.Vb(1,9),u.Jc(2,gt,2,0,"th",10),u.Jc(3,_t,4,6,"td",11),u.Ub(),u.Vb(4,12),u.Jc(5,yt,2,0,"th",10),u.Jc(6,Dt,2,1,"td",11),u.Ub(),u.Vb(7,13),u.Jc(8,St,2,0,"th",10),u.Jc(9,Wt,3,4,"td",14),u.Ub(),u.Jc(10,Xt,1,0,"tr",15),u.Jc(11,wt,1,0,"tr",16),u.Wb()),2&t){var n=u.nc(2);u.tc("dataSource",n.mds),u.Db(10),u.tc("matHeaderRowDef",n.transactionTableColumns),u.Db(1),u.tc("matRowDefColumns",n.transactionTableColumns)}}function Lt(t,i){if(1&t&&(u.Xb(0,"span"),u.Lc(1),u.Sb(2,"br"),u.Wb()),2&t){var n=u.nc(2);u.Db(1),u.Nc("Current user is ",n.station.current_session.user.fullname," ")}}function Tt(t,i){if(1&t&&(u.Xb(0,"h1"),u.Lc(1),u.oc(2,"currency"),u.Xb(3,"small"),u.Lc(4,"Total Sales"),u.Wb(),u.Wb()),2&t){var n=u.nc(2);u.Db(1),u.Nc("",u.qc(2,1,n.sales," ")," ")}}function Ct(t,i){if(1&t){var n=u.Yb();u.Xb(0,"button",22),u.jc("click",(function(t){return u.Cc(n),u.nc(2).leaveSession()})),u.Xb(1,"mat-icon"),u.Lc(2,"exit_to_app"),u.Wb(),u.Lc(3),u.Wb()}if(2&t){var e=u.nc(2);u.tc("disabled",e.isLeaving),u.Db(3),u.Nc(" ",e.isLeaving?"Leaving Session...":"Leave Session","")}}function Jt(t,i){if(1&t&&(u.Xb(0,"div"),u.Xb(1,"div",1),u.Xb(2,"div",2),u.Xb(3,"mat-card"),u.Xb(4,"mat-card-header"),u.Xb(5,"mat-card-title"),u.Lc(6),u.Wb(),u.Xb(7,"mat-card-subtitle"),u.Sb(8,"br"),u.Jc(9,ht,2,1,"button",3),u.Wb(),u.Wb(),u.Xb(10,"mat-card-content"),u.Jc(11,vt,1,0,"app-ellipis-loading",0),u.Jc(12,It,12,3,"table",4),u.Wb(),u.Wb(),u.Wb(),u.Xb(13,"div",5),u.Xb(14,"mat-card"),u.Xb(15,"mat-card-header"),u.Xb(16,"mat-card-title"),u.Lc(17,"Session Summary"),u.Wb(),u.Wb(),u.Xb(18,"mat-card-content"),u.Jc(19,Lt,3,1,"span",0),u.Lc(20),u.oc(21,"dfnsDistanceInWordsToNow"),u.oc(22,"parseDate"),u.Sb(23,"br"),u.Sb(24,"br"),u.Jc(25,Tt,5,4,"h1",0),u.Sb(26,"br"),u.Sb(27,"br"),u.Jc(28,Ct,4,2,"button",6),u.Wb(),u.Wb(),u.Wb(),u.Wb(),u.Wb()),2&t){var n=u.nc();u.Db(6),u.Nc("Transactions on ",n.station.description," "),u.Db(3),u.tc("ngIf",n.isOnDuty),u.Db(2),u.tc("ngIf",n.isLoadingTransactions),u.Db(1),u.tc("ngIf",0==n.isLoadingTransactions),u.Db(7),u.tc("ngIf",0==n.isOnDuty),u.Db(1),u.Nc(" Started ",u.pc(21,8,u.pc(22,10,n.station.current_session.time_in))," ago "),u.Db(5),u.tc("ngIf",!n.isLoadingTransactions),u.Db(3),u.tc("ngIf",n.isOnDuty)}}function qt(t,i){1&t&&u.Sb(0,"app-ellipis-loading")}var Mt=function(){function t(t,i,n,e,a,c,s,o,l,b,u){this.activatedRoute=t,this.stationService=i,this.modalService=n,this.stateService=e,this.router=a,this.authService=c,this.paperSizeService=s,this.printQualityService=o,this.serviceRateService=l,this.serviceTransacrionService=b,this.dialog=u,this.station=null,this.isLeaving=!1,this.isOnDuty=!1,this.paper_sizes=[],this.print_qualities=[],this.service_rates=[],this.transactionTableColumns=["time","member","sales"],this.sales=0,this.isLoadingTransactions=!0,this.transactions=[],this.mds=new r.k}return t.prototype.ngOnInit=function(){var t=this;this.station=this.stateService.get("active_station"),null==this.station?this.stationService.read(this.activatedRoute.snapshot.params.station).subscribe((function(i){i.current_session?(t.station=i,t.isOnDuty=t.authService.user.id==t.station.current_session.user_id,t.isOnDuty&&t.stateService.set("active_station",i),t.fetchTransactions()):t.router.navigate(["/service-transactions"])}),(function(i){t.modalService.toast("Error reading station"),t.router.navigate(["/service-transactions"])})):(this.isOnDuty=this.authService.user.id==this.station.current_session.user_id,this.fetchTransactions()),this.fetchConfig()},t.prototype.fetchConfig=function(){var t=this;this.paper_sizes=this.stateService.get("paper_sizes"),this.print_qualities=this.stateService.get("print_qualities"),this.service_rates=this.stateService.get("service_rates"),null==this.paper_sizes&&this.paperSizeService.query().subscribe((function(i){t.paper_sizes=i,t.stateService.set("paper_sizes",i)})),null==this.print_qualities&&this.printQualityService.query().subscribe((function(i){t.print_qualities=i,t.stateService.set("print_qualities",i)})),null==this.service_rates&&this.serviceRateService.query().subscribe((function(i){t.service_rates=i.map((function(t){return(new at.a).fill(t)})),t.stateService.set("service_rates",t.service_rates)}))},t.prototype.leaveSession=function(){var t=this;this.modalService.prompt({question:"Please enter your password to continue",required:!0,password:!0}).then((function(i){i&&(t.isLeaving=!0,t.stationService.leave(t.station,i).subscribe((function(i){t.stateService.set("active_station",null),t.modalService.toast("You leaved the session","Session leaved"),t.router.navigate(["/service-transactions"]),t.isLeaving=!1}),(function(i){"Password is incorrect"==i.error.message?t.modalService.swal({text:"Incorrect password",title:"Oops!",icon:"error"}):t.modalService.toast("Something went wrong","Oops!","error"),t.isLeaving=!1})))}))},t.prototype.newTransaction=function(){var t=this;this.dialog.open(et,{width:"90%",disableClose:!0,data:{station:this.station,paper_sizes:this.paper_sizes,print_qualities:this.print_qualities,service_rates:this.service_rates}}).afterClosed().subscribe((function(i){i&&(t.transactions.unshift(i),t.mds.connect().next(t.transactions),t.sales+=Number(i.sales))}))},t.prototype.fetchTransactions=function(){var t=this;this.isLoadingTransactions=!0,this.serviceTransacrionService.query({params:{time:this.station.current_session.time_in,station_id:this.station.id}}).subscribe((function(i){t.transactions=i,t.mds.connect().next(t.transactions),t.isLoadingTransactions=!1,t.sales=0,t.transactions.forEach((function(i){t.sales+=Number(i.sales)}))}))},t.\u0275fac=function(i){return new(i||t)(u.Rb(ct.a),u.Rb(rt),u.Rb(d.a),u.Rb(st.a),u.Rb(ct.g),u.Rb(ot.a),u.Rb(lt.a),u.Rb(bt.a),u.Rb(ut.a),u.Rb(m),u.Rb(a.b))},t.\u0275cmp=u.Lb({type:t,selectors:[["app-show"]],decls:2,vars:2,consts:[[4,"ngIf"],[1,"row"],[1,"col-lg-8"],["mat-raised-button","","color","primary",3,"disabled","click",4,"ngIf"],["mat-table","","class","full-width",3,"dataSource",4,"ngIf"],[1,"col-lg-4"],["mat-raised-button","","color","warn",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","primary",3,"disabled","click"],["mat-table","",1,"full-width",3,"dataSource"],["matColumnDef","time"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","member"],["matColumnDef","sales"],["mat-cell","","class","text-right pr-2",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-cell","",1,"text-right","pr-2"],["mat-header-row",""],["mat-row",""],["mat-raised-button","","color","warn",3,"disabled","click"]],template:function(t,i){1&t&&(u.Jc(0,Jt,29,12,"div",0),u.Jc(1,qt,1,0,"app-ellipis-loading",0)),2&t&&(u.tc("ngIf",i.station&&null!=i.station.current_session),u.Db(1),u.tc("ngIf",null==i.station))},directives:[e.m,dt.a,dt.d,dt.g,dt.f,dt.c,y.b,ft.a,r.j,r.c,r.e,r.b,r.g,r.i,r.d,r.a,r.f,r.h,D.a],pipes:[pt.c,mt.a,pt.d,e.d],styles:[""]}),t}();function kt(t,i){if(1&t&&(u.Xb(0,"div"),u.Lc(1," Logged User: "),u.Xb(2,"span",5),u.Lc(3),u.Wb(),u.Sb(4,"br"),u.Sb(5,"br"),u.Xb(6,"a",6),u.Lc(7,"View Transactions"),u.Wb(),u.Wb()),2&t){var n=u.nc().$implicit;u.Db(3),u.Mc(n.current_session.user.fullname),u.Db(3),u.tc("routerLink","/service-transactions/"+n.id)}}function zt(t,i){if(1&t&&(u.Xb(0,"span"),u.Lc(1),u.oc(2,"dfnsDistanceInWordsToNow"),u.oc(3,"parseDate"),u.Wb()),2&t){var n=u.nc(2).$implicit;u.Db(1),u.Oc(" Last used by ",n.previous_session.user.firstname," ",u.pc(2,2,u.pc(3,4,n.previous_session.time_out))," ago ")}}function Rt(t,i){if(1&t){var n=u.Yb();u.Xb(0,"div",7),u.Jc(1,zt,4,6,"span",0),u.Sb(2,"br"),u.Sb(3,"br"),u.Xb(4,"button",8),u.jc("click",(function(t){u.Cc(n);var i=u.nc().$implicit;return u.nc(2).useStation(i)})),u.Lc(5),u.Wb(),u.Wb()}if(2&t){var e=u.nc().$implicit;u.Db(1),u.tc("ngIf",e.previous_session),u.Db(3),u.tc("disabled",e.isJoining||0==e.allowed_to_use),u.Db(1),u.Mc(e.isJoining?"Loading...":"Use")}}function $t(t,i){if(1&t&&(u.Xb(0,"div",3),u.Xb(1,"mat-card"),u.Xb(2,"mat-card-header"),u.Xb(3,"mat-card-title-group"),u.Xb(4,"mat-card-title"),u.Xb(5,"mat-icon"),u.Lc(6,"desktop_windows"),u.Wb(),u.Lc(7),u.Wb(),u.Wb(),u.Wb(),u.Xb(8,"mat-card-content"),u.Jc(9,kt,8,2,"div",0),u.Jc(10,Rt,6,3,"div",4),u.Wb(),u.Wb(),u.Wb()),2&t){var n=i.$implicit;u.Db(7),u.Nc(" ",n.description," "),u.Db(2),u.tc("ngIf",n.current_session),u.Db(1),u.tc("ngIf",null==n.current_session)}}function Ot(t,i){if(1&t&&(u.Xb(0,"div"),u.Xb(1,"h1"),u.Lc(2,"Choose Station"),u.Wb(),u.Xb(3,"div",1),u.Jc(4,$t,11,3,"div",2),u.Wb(),u.Wb()),2&t){var n=u.nc();u.Db(4),u.tc("ngForOf",n.stations)}}function jt(t,i){1&t&&(u.Xb(0,"h1"),u.Lc(1,"Loading Stations..."),u.Wb())}var Nt=[{path:"",component:function(){function t(t,i,n,e,a){this.stationService=t,this.authService=i,this.router=n,this.stateService=e,this.modalService=a,this.fetchingStations=!1}return t.prototype.ngOnInit=function(){var t=this.stateService.get("active_station");t?this.setActiveStation(t):this.fetchStations()},t.prototype.fetchStations=function(){var t=this;this.fetchingStations=!0,this.stationService.query().subscribe((function(i){var n=null;i.forEach((function(i){i.current_session&&i.current_session.user_id==t.authService.user.id&&(n=i)})),null==n?t.stations=i:t.setActiveStation(n),t.fetchingStations=!1}))},t.prototype.useStation=function(t){var i=this;this.modalService.prompt({question:"Please enter your password to continue",required:!0,password:!0}).then((function(n){n&&(t.isJoining=!0,i.stationService.use(t,n).subscribe((function(t){t.isJoining=!1,i.setActiveStation(t)}),(function(n){t.isJoining=!1,i.modalService.alert({message:"Password is not correct",type:"warn"})})))}))},t.prototype.setActiveStation=function(t){this.stateService.set("active_station",t),this.router.navigate(["/service-transactions/"+t.id])},t.\u0275fac=function(i){return new(i||t)(u.Rb(rt),u.Rb(ot.a),u.Rb(ct.g),u.Rb(st.a),u.Rb(d.a))},t.\u0275cmp=u.Lb({type:t,selectors:[["app-index"]],decls:2,vars:2,consts:[[4,"ngIf"],[1,"row"],["class","col-lg-3",4,"ngFor","ngForOf"],[1,"col-lg-3"],["class","text-muted",4,"ngIf"],[1,"text-primary"],["mat-raised-button","","color","primary",3,"routerLink"],[1,"text-muted"],["mat-raised-button","","color","primary",3,"disabled","click"]],template:function(t,i){1&t&&(u.Jc(0,Ot,5,1,"div",0),u.Jc(1,jt,2,0,"h1",0)),2&t&&(u.tc("ngIf",i.stations),u.Db(1),u.tc("ngIf",i.fetchingStations))},directives:[e.m,e.l,dt.a,dt.d,dt.h,dt.g,D.a,dt.c,y.a,ct.j,y.b],pipes:[pt.c,mt.a],styles:[""]}),t}()},{path:":station",component:Mt}],Yt=function(){function t(){}return t.\u0275mod=u.Pb({type:t}),t.\u0275inj=u.Ob({factory:function(i){return new(i||t)},imports:[[ct.k.forChild(Nt)],ct.k]}),t}(),xt=n("FpXt");n.d(i,"ServiceTransactionsModule",(function(){return Pt}));var Pt=function(){function t(){}return t.\u0275mod=u.Pb({type:t}),t.\u0275inj=u.Ob({factory:function(i){return new(i||t)},imports:[[e.c,Yt,xt.a]]}),t}()}}]);