(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{iSG3:function(t,n,i){"use strict";i.r(n);var e=i("Valr"),r=i("DUip"),a=i("ea4N"),c=i("mrSG"),s=i("gSfl"),o=function(t){function n(){return t.call(this)||this}return Object(c.b)(n,t),n.prototype.computeSales=function(){var t=this;return this.sales=0,this.transaction_items&&this.transaction_items.filter((function(t){return t.is_ready})).forEach((function(n){t.sales+=n.total})),this.sales},Object.defineProperty(n.prototype,"computedSales",{get:function(){return this.computeSales()},enumerable:!0,configurable:!0}),n}(s.a),l=i("cPJV"),b=function(t){function n(){var n=t.call(this)||this;return n.quantity=1,n.price=1,n._valid=!1,n}return Object(c.b)(n,t),Object.defineProperty(n.prototype,"total",{get:function(){return this.quantity*this.price},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"is_ready",{get:function(){return this._valid||this.paper_size_id&&this.print_quality_id&&this.price>0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"dirty",{get:function(){return(this.paper_size_id||this.print_quality_id)&&!this.valid},enumerable:!0,configurable:!0}),n.prototype.reset=function(){this.paper_size_id=null,this.print_quality_id=null,this.quantity=1,this.price=1,this._valid=!1,this.paper_size=null,this.print_quality=null},n.prototype.markAsValid=function(){this._valid=!0},Object.defineProperty(n.prototype,"valid",{get:function(){return this._valid},enumerable:!0,configurable:!0}),n}(s.a),m=i("ETwC"),u=i("TYT/"),d=i("fB3y"),f=i("cUzu"),p=function(t){function n(n){var i=t.call(this,n,"print-transactions")||this;return i.http=n,i}return Object(c.b)(n,t),n.\u0275fac=function(t){return new(t||n)(u.ec(f.b))},n.\u0275prov=u.Mb({token:n,factory:n.\u0275fac,providedIn:"root"}),n}(d.a),h=i("WHFS"),v=i("eHTH"),g=i("agxM"),I=i("QJY3"),C=i("cSbt"),_=i("p+mS"),V=i("GsDI"),W=i("MqYC"),y=["cancelButton"];function w(t,n){if(1&t&&(u.Wb(0,"mat-option",32),u.Kc(1),u.Vb()),2&t){var i=n.$implicit;u.sc("value",i.id),u.Cb(1),u.Mc(" ",i.fullname," ")}}function T(t,n){1&t&&(u.Wb(0,"th",33),u.Kc(1," Size "),u.Vb())}function K(t,n){if(1&t&&(u.Wb(0,"span"),u.Kc(1),u.Vb()),2&t){var i=u.mc().$implicit;u.Cb(1),u.Lc(i.paper_size.description)}}function D(t,n){if(1&t&&(u.Wb(0,"mat-option",32),u.Kc(1),u.Vb()),2&t){var i=n.$implicit;u.sc("value",i.id),u.Cb(1),u.Nc("",i.description," ",i.dimension,"")}}function M(t,n){if(1&t){var i=u.Xb();u.Wb(0,"mat-form-field"),u.Wb(1,"mat-select",36),u.ic("ngModelChange",(function(t){return u.Bc(i),u.mc(2).currentTransactionItem.paper_size_id=t}))("selectionChange",(function(t){return u.Bc(i),u.mc(2).setPrice()})),u.Ic(2,D,2,3,"mat-option",7),u.Vb(),u.Vb()}if(2&t){var e=u.mc(2);u.Cb(1),u.sc("ngModel",e.currentTransactionItem.paper_size_id),u.Cb(1),u.sc("ngForOf",e.printer.current_session.paper_sizes)}}function S(t,n){if(1&t&&(u.Wb(0,"td",34),u.Ic(1,K,2,1,"span",35),u.Ic(2,M,3,2,"mat-form-field",35),u.Vb()),2&t){var i=n.$implicit;u.Cb(1),u.sc("ngIf",i.valid),u.Cb(1),u.sc("ngIf",!i.valid)}}function q(t,n){1&t&&(u.Wb(0,"th",33),u.Kc(1," Quality "),u.Vb())}function k(t,n){if(1&t&&(u.Wb(0,"span"),u.Kc(1),u.Vb()),2&t){var i=u.mc().$implicit;u.Cb(1),u.Lc(i.print_quality.description)}}function R(t,n){if(1&t&&(u.Wb(0,"mat-option",32),u.Kc(1),u.Vb()),2&t){var i=n.$implicit;u.sc("value",i.id),u.Cb(1),u.Lc(i.description)}}function x(t,n){if(1&t){var i=u.Xb();u.Wb(0,"mat-form-field"),u.Wb(1,"mat-select",38),u.ic("ngModelChange",(function(t){return u.Bc(i),u.mc(2).currentTransactionItem.print_quality_id=t}))("selectionChange",(function(t){return u.Bc(i),u.mc(2).setPrice()})),u.Ic(2,R,2,2,"mat-option",7),u.Vb(),u.Vb()}if(2&t){var e=u.mc(2);u.Cb(1),u.sc("ngModel",e.currentTransactionItem.print_quality_id),u.Cb(1),u.sc("ngForOf",e.printer.current_session.print_qualities)}}function O(t,n){if(1&t&&(u.Wb(0,"td",37),u.Ic(1,k,2,1,"span",35),u.Ic(2,x,3,2,"mat-form-field",35),u.Vb()),2&t){var i=n.$implicit;u.Cb(1),u.sc("ngIf",i.valid),u.Cb(1),u.sc("ngIf",!i.valid)}}function P(t,n){1&t&&(u.Wb(0,"th",33),u.Kc(1," Quantity "),u.Vb())}function U(t,n){if(1&t){var i=u.Xb();u.Wb(0,"mat-form-field"),u.Wb(1,"input",40),u.ic("ngModelChange",(function(t){return u.Bc(i),u.mc().$implicit.quantity=t})),u.Vb(),u.Vb()}if(2&t){var e=u.mc().$implicit;u.Cb(1),u.sc("ngModel",e.quantity)}}function z(t,n){if(1&t&&(u.Wb(0,"td",39),u.Ic(1,U,2,1,"mat-form-field",35),u.Vb()),2&t){var i=n.$implicit;u.Cb(1),u.sc("ngIf",i.is_ready)}}function $(t,n){1&t&&(u.Wb(0,"th",41),u.Kc(1," Price "),u.Vb())}function j(t,n){if(1&t&&(u.Wb(0,"span"),u.Kc(1),u.Vb()),2&t){var i=u.mc().$implicit;u.Cb(1),u.Lc(i.price)}}function Q(t,n){if(1&t&&(u.Wb(0,"td",39),u.Ic(1,j,2,1,"span",35),u.Vb()),2&t){var i=n.$implicit;u.Cb(1),u.sc("ngIf",i.is_ready)}}function L(t,n){1&t&&(u.Wb(0,"th",42),u.Kc(1," Amount "),u.Vb())}function H(t,n){if(1&t&&(u.Wb(0,"span"),u.Kc(1),u.Vb()),2&t){var i=u.mc().$implicit;u.Cb(1),u.Lc(i.total)}}function J(t,n){if(1&t&&(u.Wb(0,"td",39),u.Ic(1,H,2,1,"span",35),u.Vb()),2&t){var i=n.$implicit;u.Cb(1),u.sc("ngIf",i.is_ready)}}function B(t,n){1&t&&u.Rb(0,"th",43)}function Y(t,n){1&t&&(u.Wb(0,"mat-icon"),u.Kc(1,"remove"),u.Vb())}function X(t,n){1&t&&(u.Wb(0,"mat-icon"),u.Kc(1,"refresh"),u.Vb())}function F(t,n){if(1&t){var i=u.Xb();u.Wb(0,"button",46),u.ic("click",(function(t){u.Bc(i);var n=u.mc().$implicit;return u.mc().removeItem(n)})),u.Ic(1,Y,2,0,"mat-icon",35),u.Ic(2,X,2,0,"mat-icon",35),u.Vb()}if(2&t){var e=u.mc().$implicit,r=u.mc();u.Cb(1),u.sc("ngIf",e.valid),u.Cb(1),u.sc("ngIf",e.dirty&&r.transaction.transaction_items.length>1)}}function A(t,n){if(1&t&&(u.Wb(0,"td",44),u.Ic(1,F,3,2,"button",45),u.Vb()),2&t){var i=n.$implicit,e=u.mc();u.Cb(1),u.sc("ngIf",i.valid||e.transaction.transaction_items.length>1)}}function N(t,n){1&t&&u.Rb(0,"tr",47)}function E(t,n){1&t&&u.Rb(0,"tr",48)}function G(t,n){if(1&t){var i=u.Xb();u.Wb(0,"button",49),u.ic("click",(function(t){return u.Bc(i),u.mc().addItem()})),u.Rb(1,"i",50),u.Vb()}}var Z=function(){function t(t,n,i,e){this.dialogRef=t,this.printTransactionService=n,this.modalService=i,this.matData=e,this.members=[{id:"1",fullname:"Anonymous"}],this.transactionItemTableColumns=["size","quality","quantity","price","total","action"],this.savingTransaction=!1,this.transaction=new o,this.transaction.member_id="1",this.transaction.time=l(new Date,"MMM DD, YYYY hh:mm A"),this.currentTransactionItem=new b,this.transaction.transaction_items=[this.currentTransactionItem],this.mds=new m.k(this.transaction.transaction_items),this.printer=e.printer}return t.prototype.ngOnInit=function(){},t.prototype.ngAfterViewInit=function(){},t.prototype.addItem=function(){this.currentTransactionItem&&this.currentTransactionItem.paper_size&&this.currentTransactionItem.print_quality&&(this.checkDuplicates()||(this.currentTransactionItem.markAsValid(),this.currentTransactionItem=new b,this.transaction.transaction_items.push(this.currentTransactionItem)),this.mds.connect().next(this.transaction.transaction_items),this.transaction.computeSales())},t.prototype.checkDuplicates=function(){var t=this,n=!1;return this.transaction.transaction_items.forEach((function(i,e){!n&&i.valid&&i.paper_size_id===t.currentTransactionItem.paper_size_id&&i.print_quality_id===t.currentTransactionItem.print_quality_id&&(n=!0,i.quantity+=t.currentTransactionItem.quantity,t.currentTransactionItem.reset())})),n},t.prototype.removeItem=function(t){t.valid?this.transaction.transaction_items=this.transaction.transaction_items.filter((function(n){return n.paper_size_id!=t.paper_size_id&&n.print_quality_id!=t.print_quality_id&&n.valid})):this.currentTransactionItem.reset(),this.mds.connect().next(this.transaction.transaction_items)},t.prototype.saveTransaction=function(){var t=this;this.modalService.confirm({message:"Save this transaction?"}).then((function(n){n&&(t.checkDuplicates(),t.currentTransactionItem.is_ready&&t.addItem(),t.transaction.transaction_items=t.transaction.transaction_items.filter((function(t){return t.valid})),t.transaction.printer_id=t.printer.id,t.savingTransaction=!0,t.printTransactionService.create(t.transaction).subscribe((function(n){t.modalService.toast("Transaction saved!"),t.dialogRef.close(n),t.savingTransaction=!1}),(function(n){t.modalService.swal({title:"Saving Transaction Failed",text:"Unknown Error Occured",icon:"error"}),t.savingTransaction=!1})))}))},t.prototype.setPrice=function(){var t=this;this.currentTransactionItem.price=0,this.currentTransactionItem.paper_size=null,this.currentTransactionItem.print_quality=null,this.printer.current_session.print_rates.forEach((function(n){t.currentTransactionItem.paper_size_id==n.paper_size_id&&t.currentTransactionItem.print_quality_id==n.print_quality_id&&(t.currentTransactionItem.price=n.rate,t.currentTransactionItem.paper_size=n.paper_size,t.currentTransactionItem.print_quality=n.print_quality)}))},t.\u0275fac=function(n){return new(n||t)(u.Qb(a.g),u.Qb(p),u.Qb(h.a),u.Qb(a.a))},t.\u0275cmp=u.Kb({type:t,selectors:[["app-create-transaction"]],viewQuery:function(t,n){var i;1&t&&u.Pc(y,!0),2&t&&u.zc(i=u.jc())&&(n.cancelButton=i.first)},decls:53,vars:15,consts:[["mat-dialog-title",""],[1,"fa","fa-print"],[1,"mat-typography"],[1,"row"],[1,"col-lg-3"],[1,"full-width"],[3,"ngModel","disabled","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["matInput","","disabled","",3,"ngModel","ngModelChange"],[1,"p-1","bg-primary"],[1,"col-lg-12"],["mat-table","",1,"full-width",3,"dataSource"],["matColumnDef","size"],["mat-header-cell","","style","width: 20%;",4,"matHeaderCellDef"],["mat-cell","","class","pr-3",4,"matCellDef"],["matColumnDef","quality"],["mat-cell","","class","p-2",4,"matCellDef"],["matColumnDef","quantity"],["mat-cell","","class","text-center",4,"matCellDef"],["matColumnDef","price"],["mat-header-cell","","style","width: 20%;","class","text-center",4,"matHeaderCellDef"],["matColumnDef","total",2,"width","10%"],["mat-header-cell","","class","text-center",4,"matHeaderCellDef"],["matColumnDef","action"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["align","end"],["mat-raised-button","",3,"click",4,"ngIf"],["mat-raised-button","",3,"disabled","click"],["mat-button","","mat-dialog-close","",3,"disabled"],[3,"value"],["mat-header-cell","",2,"width","20%"],["mat-cell","",1,"pr-3"],[4,"ngIf"],["aria-placeholder","Size",3,"ngModel","ngModelChange","selectionChange"],["mat-cell","",1,"p-2"],["aria-placeholder","Quality",3,"ngModel","ngModelChange","selectionChange"],["mat-cell","",1,"text-center"],["matInput","","type","number","autocomplete","off","min","1",1,"text-center",3,"ngModel","ngModelChange"],["mat-header-cell","",1,"text-center",2,"width","20%"],["mat-header-cell","",1,"text-center"],["mat-header-cell",""],["mat-cell",""],["mat-raised-button","","color","error",3,"click",4,"ngIf"],["mat-raised-button","","color","error",3,"click"],["mat-header-row",""],["mat-row",""],["mat-raised-button","",3,"click"],[1,"fa","fa-plus"]],template:function(t,n){1&t&&(u.Wb(0,"h2",0),u.Rb(1,"i",1),u.Kc(2," New Print Transaction"),u.Vb(),u.Wb(3,"mat-dialog-content",2),u.Wb(4,"div",3),u.Wb(5,"div",4),u.Wb(6,"mat-form-field",5),u.Wb(7,"mat-label"),u.Kc(8,"Member"),u.Vb(),u.Wb(9,"mat-select",6),u.ic("ngModelChange",(function(t){return n.transaction.member_id=t})),u.Ic(10,w,2,2,"mat-option",7),u.Vb(),u.Vb(),u.Vb(),u.Wb(11,"div",4),u.Wb(12,"mat-form-field",5),u.Wb(13,"mat-label"),u.Kc(14,"Transacttion Time"),u.Vb(),u.Wb(15,"input",8),u.ic("ngModelChange",(function(t){return n.transaction.time=t})),u.Vb(),u.Vb(),u.Vb(),u.Wb(16,"div",4),u.Wb(17,"h2",9),u.Kc(18),u.nc(19,"currency"),u.Vb(),u.Vb(),u.Vb(),u.Wb(20,"div",3),u.Wb(21,"div",10),u.Wb(22,"table",11),u.Ub(23,12),u.Ic(24,T,2,0,"th",13),u.Ic(25,S,3,2,"td",14),u.Tb(),u.Ub(26,15),u.Ic(27,q,2,0,"th",13),u.Ic(28,O,3,2,"td",16),u.Tb(),u.Ub(29,17),u.Ic(30,P,2,0,"th",13),u.Ic(31,z,2,1,"td",18),u.Tb(),u.Ub(32,19),u.Ic(33,$,2,0,"th",20),u.Ic(34,Q,2,1,"td",18),u.Tb(),u.Ub(35,21),u.Ic(36,L,2,0,"th",22),u.Ic(37,J,2,1,"td",18),u.Tb(),u.Ub(38,23),u.Ic(39,B,1,0,"th",24),u.Ic(40,A,2,1,"td",25),u.Tb(),u.Ic(41,N,1,0,"tr",26),u.Ic(42,E,1,0,"tr",27),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Wb(43,"mat-dialog-actions",28),u.Ic(44,G,2,0,"button",29),u.Wb(45,"button",30),u.ic("click",(function(t){return n.saveTransaction()})),u.Wb(46,"mat-icon"),u.Kc(47,"save"),u.Vb(),u.Kc(48),u.Vb(),u.Wb(49,"button",31),u.Wb(50,"mat-icon"),u.Kc(51,"remove"),u.Vb(),u.Kc(52," Cancel"),u.Vb(),u.Vb()),2&t&&(u.Cb(9),u.sc("ngModel",n.transaction.member_id)("disabled",!0),u.Cb(1),u.sc("ngForOf",n.members),u.Cb(5),u.sc("ngModel",n.transaction.time),u.Cb(3),u.Mc("Total: ",u.pc(19,12,n.transaction.computedSales," "),""),u.Cb(4),u.sc("dataSource",n.mds),u.Cb(19),u.sc("matHeaderRowDef",n.transactionItemTableColumns),u.Cb(1),u.sc("matRowDefColumns",n.transactionItemTableColumns),u.Cb(2),u.sc("ngIf",null==n.currentTransactionItem||n.currentTransactionItem.is_ready&&0==n.currentTransactionItem.valid),u.Cb(1),u.sc("disabled",!n.currentTransactionItem.is_ready&&1==n.transaction.transaction_items.length||n.savingTransaction),u.Cb(3),u.Mc(" ",n.savingTransaction?"Saving Transaction...":"Save Transaction"," "),u.Cb(1),u.sc("disabled",n.savingTransaction))},directives:[a.h,a.e,v.b,v.e,g.a,I.k,I.n,e.l,C.a,I.b,m.j,m.c,m.e,m.b,m.g,m.i,a.c,e.m,_.b,V.a,a.d,W.h,m.d,m.a,I.p,m.f,m.h],pipes:[e.d],styles:[""]}),t}();function tt(t,n){1&t&&(u.Wb(0,"th",28),u.Kc(1," Size "),u.Vb())}function nt(t,n){if(1&t&&(u.Wb(0,"td",29),u.Kc(1),u.Vb()),2&t){var i=n.$implicit;u.Cb(1),u.Mc(" ",i.paper_size.description," ")}}function it(t,n){1&t&&(u.Wb(0,"th",28),u.Kc(1," Quality "),u.Vb())}function et(t,n){if(1&t&&(u.Wb(0,"td",30),u.Kc(1),u.Vb()),2&t){var i=n.$implicit;u.Cb(1),u.Mc(" ",i.print_quality.description," ")}}function rt(t,n){1&t&&(u.Wb(0,"th",28),u.Kc(1," Quantity "),u.Vb())}function at(t,n){if(1&t&&(u.Wb(0,"td",31),u.Kc(1),u.Vb()),2&t){var i=n.$implicit;u.Cb(1),u.Mc(" ",i.quantity," ")}}function ct(t,n){1&t&&(u.Wb(0,"th",32),u.Kc(1," Price "),u.Vb())}function st(t,n){if(1&t&&(u.Wb(0,"td",33),u.Kc(1),u.Vb()),2&t){var i=n.$implicit;u.Cb(1),u.Mc(" ",i.price," ")}}function ot(t,n){1&t&&(u.Wb(0,"th",34),u.Kc(1," Amount "),u.Vb())}function lt(t,n){if(1&t&&(u.Wb(0,"td",33),u.Kc(1),u.Vb()),2&t){var i=n.$implicit;u.Cb(1),u.Mc(" ",i.total," ")}}function bt(t,n){1&t&&u.Rb(0,"tr",35)}function mt(t,n){1&t&&u.Rb(0,"tr",36)}function ut(t,n){if(1&t){var i=u.Xb();u.Wb(0,"mat-dialog-content",5),u.Wb(1,"div",6),u.Wb(2,"div",7),u.Wb(3,"mat-form-field",8),u.Wb(4,"mat-label"),u.Kc(5,"Member"),u.Vb(),u.Rb(6,"input",9),u.Vb(),u.Vb(),u.Wb(7,"div",7),u.Wb(8,"mat-form-field",8),u.Wb(9,"mat-label"),u.Kc(10,"User"),u.Vb(),u.Rb(11,"input",9),u.Vb(),u.Vb(),u.Wb(12,"div",7),u.Wb(13,"mat-form-field",8),u.Wb(14,"mat-label"),u.Kc(15,"Transacttion Time"),u.Vb(),u.Wb(16,"input",10),u.ic("ngModelChange",(function(t){return u.Bc(i),u.mc().transaction.time=t})),u.Vb(),u.Vb(),u.Vb(),u.Wb(17,"div",7),u.Wb(18,"h2",11),u.Kc(19),u.nc(20,"currency"),u.Vb(),u.Vb(),u.Vb(),u.Wb(21,"div",6),u.Wb(22,"div",12),u.Wb(23,"table",13),u.Ub(24,14),u.Ic(25,tt,2,0,"th",15),u.Ic(26,nt,2,1,"td",16),u.Tb(),u.Ub(27,17),u.Ic(28,it,2,0,"th",15),u.Ic(29,et,2,1,"td",18),u.Tb(),u.Ub(30,19),u.Ic(31,rt,2,0,"th",15),u.Ic(32,at,2,1,"td",20),u.Tb(),u.Ub(33,21),u.Ic(34,ct,2,0,"th",22),u.Ic(35,st,2,1,"td",23),u.Tb(),u.Ub(36,24),u.Ic(37,ot,2,0,"th",25),u.Ic(38,lt,2,1,"td",23),u.Tb(),u.Ic(39,bt,1,0,"tr",26),u.Ic(40,mt,1,0,"tr",27),u.Vb(),u.Vb(),u.Vb(),u.Vb()}if(2&t){var e=u.mc();u.Cb(6),u.sc("value",e.transaction.member.fullname),u.Cb(5),u.sc("value",e.transaction.user.username),u.Cb(5),u.sc("ngModel",e.transaction.time),u.Cb(3),u.Mc("Sales: ",u.pc(20,7,e.transaction.sales," "),""),u.Cb(4),u.sc("dataSource",e.mds),u.Cb(16),u.sc("matHeaderRowDef",e.transactionItemTableColumns),u.Cb(1),u.sc("matRowDefColumns",e.transactionItemTableColumns)}}var dt=function(){function t(t,n){this.matData=t,this.printTransactionService=n,this.transactionItemTableColumns=["size","quality","quantity","price","total"],this.tId=t.transaction.id,this.mds=new m.k}return t.prototype.ngOnInit=function(){var t=this;this.printTransactionService.read(this.tId,{params:{transaction_items:1,member:1,user:1}}).subscribe((function(n){t.transaction=n,t.mds.connect().next(n.transaction_items)}))},t.\u0275fac=function(n){return new(n||t)(u.Qb(a.a),u.Qb(p))},t.\u0275cmp=u.Kb({type:t,selectors:[["app-transaction-items"]],decls:9,vars:1,consts:[["mat-dialog-title",""],[1,"fa","fa-print"],["class","mat-typography",4,"ngIf"],["align","end"],["mat-button","","mat-dialog-close",""],[1,"mat-typography"],[1,"row"],[1,"col-lg-3"],[1,"full-width"],["matInput","","type","text","disabled","",3,"value"],["matInput","","disabled","",3,"ngModel","ngModelChange"],[1,"p-1"],[1,"col-lg-12"],["mat-table","",1,"full-width",3,"dataSource"],["matColumnDef","size"],["mat-header-cell","","style","width: 20%;",4,"matHeaderCellDef"],["mat-cell","","class","pr-3",4,"matCellDef"],["matColumnDef","quality"],["mat-cell","","class","p-2",4,"matCellDef"],["matColumnDef","quantity"],["mat-cell","","class","text-center",4,"matCellDef"],["matColumnDef","price"],["mat-header-cell","","style","width: 20%;","class","text-center",4,"matHeaderCellDef"],["mat-cell","","class","text-right",4,"matCellDef"],["matColumnDef","total",2,"width","10%"],["mat-header-cell","","class","text-center",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","",2,"width","20%"],["mat-cell","",1,"pr-3"],["mat-cell","",1,"p-2"],["mat-cell","",1,"text-center"],["mat-header-cell","",1,"text-center",2,"width","20%"],["mat-cell","",1,"text-right"],["mat-header-cell","",1,"text-center"],["mat-header-row",""],["mat-row",""]],template:function(t,n){1&t&&(u.Wb(0,"h2",0),u.Rb(1,"i",1),u.Kc(2," Print Transaction"),u.Vb(),u.Ic(3,ut,41,10,"mat-dialog-content",2),u.Wb(4,"mat-dialog-actions",3),u.Wb(5,"button",4),u.Wb(6,"mat-icon"),u.Kc(7,"close"),u.Vb(),u.Kc(8," Close"),u.Vb(),u.Vb()),2&t&&(u.Cb(3),u.sc("ngIf",n.transaction))},directives:[a.h,e.m,a.c,_.b,a.d,V.a,a.e,v.b,v.e,C.a,I.b,I.k,I.n,m.j,m.c,m.e,m.b,m.g,m.i,m.d,m.a,m.f,m.h],pipes:[e.d],styles:[""]}),t}(),ft=function(t){function n(n){var i=t.call(this,n,"printers")||this;return i.http=n,i}return Object(c.b)(n,t),n.\u0275fac=function(t){return new(t||n)(u.ec(f.b))},n.\u0275prov=u.Mb({token:n,factory:n.\u0275fac,providedIn:"root"}),n}(d.a),pt=i("iPKQ"),ht=i("17Os"),vt=i("+0bg"),gt=i("H6It"),It=i("/RhQ");function Ct(t,n){if(1&t&&(u.Wb(0,"span"),u.Kc(1),u.Vb()),2&t){var i=u.mc();u.Cb(1),u.Mc("on ",i.printer.description,"")}}function _t(t,n){1&t&&(u.Wb(0,"span"),u.Kc(1,"of Previous Session"),u.Vb())}function Vt(t,n){if(1&t){var i=u.Xb();u.Wb(0,"mat-card-subtitle"),u.Wb(1,"button",15),u.ic("click",(function(t){return u.Bc(i),u.mc(2).newTransaction()})),u.Rb(2,"i",16),u.Kc(3," New"),u.Vb(),u.Vb()}}function Wt(t,n){1&t&&(u.Wb(0,"th",17),u.Kc(1," Time "),u.Vb())}function yt(t,n){if(1&t&&(u.Wb(0,"td",18),u.Kc(1),u.nc(2,"dfnsFormat"),u.nc(3,"parseDate"),u.Vb()),2&t){var i=n.$implicit;u.Cb(1),u.Mc(" ",u.pc(2,1,u.oc(3,4,i.time),"MMM DD, YYYY hh:mm A")," ")}}function wt(t,n){1&t&&(u.Wb(0,"th",17),u.Kc(1," Member "),u.Vb())}function Tt(t,n){if(1&t&&(u.Wb(0,"td",18),u.Kc(1),u.Vb()),2&t){var i=n.$implicit;u.Cb(1),u.Mc(" ",i.member.fullname," ")}}function Kt(t,n){1&t&&(u.Wb(0,"th",17),u.Kc(1," Sales "),u.Vb())}function Dt(t,n){if(1&t&&(u.Wb(0,"td",19),u.Kc(1),u.nc(2,"currency"),u.Vb()),2&t){var i=n.$implicit;u.Cb(1),u.Mc(" ",u.pc(2,1,i.sales," ")," ")}}function Mt(t,n){1&t&&u.Rb(0,"tr",20)}function St(t,n){if(1&t){var i=u.Xb();u.Wb(0,"tr",21),u.ic("click",(function(t){u.Bc(i);var e=n.$implicit;return u.mc(2).viewTransactionItems(e)})),u.Vb()}}function qt(t,n){if(1&t){var i=u.Xb();u.Wb(0,"mat-card"),u.Wb(1,"mat-card-header"),u.Wb(2,"mat-card-title",22),u.Kc(3,"No Current User"),u.Vb(),u.Vb(),u.Wb(4,"mat-card-content"),u.Wb(5,"button",23),u.ic("click",(function(t){return u.Bc(i),u.mc(2).joinPrinting()})),u.Wb(6,"mat-icon"),u.Kc(7,"meeting_room"),u.Vb(),u.Kc(8),u.Vb(),u.Vb(),u.Vb()}if(2&t){var e=u.mc(2);u.Cb(5),u.sc("disabled",e.isJoiningOrLeaving),u.Cb(3),u.Mc(" ",e.isJoiningOrLeaving?"Joining...":"Join Printing Session"," ")}}function kt(t,n){1&t&&(u.Wb(0,"mat-list-item",27),u.Kc(1,"Only 1 user can join the printing session as of now."),u.Vb())}function Rt(t,n){if(1&t){var i=u.Xb();u.Wb(0,"button",28),u.ic("click",(function(t){return u.Bc(i),u.mc(3).leavePrinting()})),u.Wb(1,"mat-icon"),u.Kc(2,"no_meeting_room"),u.Vb(),u.Kc(3),u.Vb()}if(2&t){var e=u.mc(3);u.sc("disabled",e.isJoiningOrLeaving),u.Cb(3),u.Mc(" ",e.isJoiningOrLeaving?"Leaving...":"Leave Printing"," ")}}function xt(t,n){if(1&t&&(u.Wb(0,"mat-card"),u.Wb(1,"mat-card-header"),u.Wb(2,"mat-card-title"),u.Kc(3,"Current Session"),u.Vb(),u.Vb(),u.Wb(4,"mat-card-content"),u.Wb(5,"mat-list"),u.Wb(6,"mat-list-item"),u.Kc(7),u.Vb(),u.Wb(8,"mat-list-item"),u.Kc(9),u.nc(10,"dfnsFormat"),u.nc(11,"parseDate"),u.Vb(),u.Wb(12,"mat-list-item"),u.Kc(13),u.nc(14,"currency"),u.Vb(),u.Ic(15,kt,2,0,"mat-list-item",24),u.Vb(),u.Vb(),u.Wb(16,"mat-card-actions",25),u.Ic(17,Rt,4,2,"button",26),u.Vb(),u.Vb()),2&t){var i=u.mc(2);u.Cb(7),u.Mc("User: ",i.printer.current_session.user.firstname,""),u.Cb(2),u.Mc("Time Started: ",u.pc(10,5,u.oc(11,8,i.printer.current_session.start_time),"h:m A"),""),u.Cb(4),u.Mc("Total Sales: ",u.pc(14,10,i.printer.current_session.sales," "),""),u.Cb(2),u.sc("ngIf",i.printer.current_session&&i.printer.current_session.user.id!=i.currentUser.id),u.Cb(2),u.sc("ngIf",i.printer.current_session&&i.printer.current_session.user.id==i.currentUser.id)}}function Ot(t,n){if(1&t&&(u.Wb(0,"div",3),u.Wb(1,"div",4),u.Wb(2,"mat-card"),u.Wb(3,"mat-card-header"),u.Wb(4,"mat-card-title"),u.Kc(5,"Transactions "),u.Ic(6,_t,2,0,"span",1),u.Vb(),u.Ic(7,Vt,4,0,"mat-card-subtitle",1),u.Vb(),u.Wb(8,"mat-card-content"),u.Wb(9,"table",5),u.Ub(10,6),u.Ic(11,Wt,2,0,"th",7),u.Ic(12,yt,4,6,"td",8),u.Tb(),u.Ub(13,9),u.Ic(14,wt,2,0,"th",7),u.Ic(15,Tt,2,1,"td",8),u.Tb(),u.Ub(16,10),u.Ic(17,Kt,2,0,"th",7),u.Ic(18,Dt,3,4,"td",11),u.Tb(),u.Ic(19,Mt,1,0,"tr",12),u.Ic(20,St,1,0,"tr",13),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Wb(21,"div",14),u.Ic(22,qt,9,2,"mat-card",1),u.Ic(23,xt,18,13,"mat-card",1),u.Vb(),u.Vb()),2&t){var i=u.mc();u.Cb(6),u.sc("ngIf",!i.printer.current_session),u.Cb(1),u.sc("ngIf",i.printer.current_session&&i.printer.current_session.user.id==i.currentUser.id),u.Cb(2),u.sc("dataSource",i.mds),u.Cb(10),u.sc("matHeaderRowDef",i.transactionTableColumns),u.Cb(1),u.sc("matRowDefColumns",i.transactionTableColumns),u.Cb(2),u.sc("ngIf",!i.printer.current_session),u.Cb(1),u.sc("ngIf",i.printer.current_session)}}var Pt=[{path:"",redirectTo:"printer/1",pathMatch:"full"},{path:"printer/:id",component:function(){function t(t,n,i,e,r,a){this.activatedRoute=t,this.printerService=n,this.printTransactionService=i,this.authenticationService=e,this.modalService=r,this.dialog=a,this.transactionTableColumns=["time","member","sales"],this.isJoiningOrLeaving=!1,this.mds=new m.k,this.currentUser=e.currentUser}return t.prototype.ngOnInit=function(){var t=this;this.printerService.read(this.activatedRoute.snapshot.params.id).subscribe((function(n){t.setPrinter(n)}))},t.prototype.setPrinter=function(t){this.printer=t,this.fetchTransactions()},t.prototype.fetchTransactions=function(){var t=this;this.printTransactionService.query({params:{printer_id:this.printer.id,user_id:this.currentUser.id}}).subscribe((function(n){t.transactions=n,t.mds.connect().next(n)}))},t.prototype.newTransaction=function(){var t=this;console.log(this.mds.data),this.dialog.open(Z,{width:"900px",disableClose:!0,data:{printer:this.printer}}).afterClosed().subscribe((function(n){n&&(t.transactions.unshift(n),t.mds.connect().next(t.transactions),t.printer.current_session.sales=Number(t.printer.current_session.sales)+Number(n.sales))}))},t.prototype.joinPrinting=function(){var t=this;this.modalService.prompt({question:"Please to enter your password to join the printing session",password:!0}).then((function(n){n&&(t.isJoiningOrLeaving=!0,t.printer.set_session_user_id=t.currentUser.id,t.printer.user_password=n,t.printerService.update(t.printer).subscribe((function(n){t.setPrinter(n),t.modalService.toast("You successfully joined the printing session"),t.isJoiningOrLeaving=!1}),(function(n){t.modalService.swal({text:n&&n.error&&n.error.errors&&n.error.errors.password?"Incorrect password.":"Unknown Error",title:"Join session failed",icon:"error"}),t.isJoiningOrLeaving=!1})))}))},t.prototype.leavePrinting=function(){var t=this;this.modalService.prompt({question:"Please to enter your password to leave the printing session",password:!0}).then((function(n){n&&(t.isJoiningOrLeaving=!0,t.printer.unset_session_user_id=t.currentUser.id,t.printer.user_password=n,t.printerService.update(t.printer).subscribe((function(n){t.setPrinter(n),t.modalService.toast("You successfully leaved the printing session"),t.isJoiningOrLeaving=!1}),(function(n){t.modalService.swal({text:n&&n.error&&n.error.errors&&n.error.errors.password?"Incorrect password.":"Unknown Error",title:"Leave session failed",icon:"error"}),t.isJoiningOrLeaving=!1})))}))},t.prototype.viewTransactionItems=function(t){this.dialog.open(dt,{width:"900px",data:{transaction:t}})},t.\u0275fac=function(n){return new(n||t)(u.Qb(r.a),u.Qb(ft),u.Qb(p),u.Qb(pt.a),u.Qb(h.a),u.Qb(a.b))},t.\u0275cmp=u.Kb({type:t,selectors:[["app-show"]],decls:5,vars:2,consts:[[1,"fa","fa-print"],[4,"ngIf"],["class","row",4,"ngIf"],[1,"row"],[1,"col-lg-8"],["mat-table","",1,"full-width","table-hover",3,"dataSource"],["matColumnDef","time"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","member"],["matColumnDef","sales"],["mat-cell","","class","text-right",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"click",4,"matRowDef","matRowDefColumns"],[1,"col-lg-4"],["mat-raised-button","","color","primary",3,"click"],[1,"fa","fa-plus"],["mat-header-cell",""],["mat-cell",""],["mat-cell","",1,"text-right"],["mat-header-row",""],["mat-row","",3,"click"],[1,"text-muted"],["mat-raised-button","","color","primary",3,"disabled","click"],["class","text-danger",4,"ngIf"],["align","end"],["mat-raised-button","","color","error",3,"disabled","click",4,"ngIf"],[1,"text-danger"],["mat-raised-button","","color","error",3,"disabled","click"]],template:function(t,n){1&t&&(u.Wb(0,"h1"),u.Rb(1,"i",0),u.Kc(2," Print Transactions "),u.Ic(3,Ct,2,1,"span",1),u.Vb(),u.Ic(4,Ot,24,7,"div",2)),2&t&&(u.Cb(3),u.sc("ngIf",n.printer),u.Cb(1),u.sc("ngIf",n.printer))},directives:[e.m,ht.a,ht.d,ht.g,ht.c,m.j,m.c,m.e,m.b,m.g,m.i,ht.f,_.b,m.d,m.a,m.f,m.h,V.a,vt.a,vt.b,ht.b],pipes:[gt.d,It.a,e.d],styles:[""]}),t}()}],Ut=function(){function t(){}return t.\u0275mod=u.Ob({type:t}),t.\u0275inj=u.Nb({factory:function(n){return new(n||t)},imports:[[r.j.forChild(Pt)],r.j]}),t}(),zt=i("FpXt");i.d(n,"PrintingModule",(function(){return $t}));var $t=function(){function t(){}return t.\u0275mod=u.Ob({type:t}),t.\u0275inj=u.Nb({factory:function(n){return new(n||t)},imports:[[e.c,Ut,zt.a]]}),t}()}}]);