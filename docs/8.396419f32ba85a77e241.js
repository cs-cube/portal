(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{ImkO:function(t,i,e){"use strict";e.r(i);var n=e("Valr"),a=e("ea4N"),c=e("cPJV"),s=e("ETwC"),r=e("mrSG"),o=e("gSfl"),l=function(t){function i(){var i=t.call(this)||this;return i.sales=0,i}return Object(r.b)(i,t),i.prototype.computeSales=function(){var t=this;this.transaction_items&&(this.sales=0,this.transaction_items.forEach((function(i){t.sales+=i.total})))},i}(o.a),u=function(t){function i(){var i=t.call(this)||this;return i.reset(),i}return Object(r.b)(i,t),i.prototype.markAsValid=function(){this._valid=!0},Object.defineProperty(i.prototype,"valid",{get:function(){return this._valid},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"is_ready",{get:function(){return 1==this.type&&null!=this.paper_size_id&&null!=this.print_quality_id||2==this.type},enumerable:!0,configurable:!0}),i.prototype.reset=function(){this._valid=!1,this.type=1,this.paper_size_id=null,this.print_quality_id=null,this.quantity=1,this.price=0,this.total=0},Object.defineProperty(i.prototype,"is_printing",{get:function(){return 1==this.type},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"is_scanning",{get:function(){return 2==this.type},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"type_label",{get:function(){return 1==this.type?"Print":"Scan"},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"computed_total",{get:function(){return this.quantity*this.price},enumerable:!0,configurable:!0}),i}(o.a),b=e("TYT/"),m=e("WHFS"),d=e("fB3y"),f=e("cUzu"),p=function(t){function i(i){return t.call(this,i,"service-transactions")||this}return Object(r.b)(i,t),i.\u0275fac=function(t){return new(t||i)(b.ec(f.b))},i.\u0275prov=b.Mb({token:i,factory:i.\u0275fac,providedIn:"root"}),i}(d.a),h=e("eHTH"),v=e("agxM"),g=e("QJY3"),_=e("cSbt"),y=e("p+mS"),I=e("GsDI"),C=e("MqYC"),V=["cancelButton"];function W(t,i){if(1&t&&(b.Wb(0,"mat-option",33),b.Kc(1),b.Vb()),2&t){var e=i.$implicit;b.sc("value",e.id),b.Cb(1),b.Mc(" ",e.fullname," ")}}function S(t,i){1&t&&(b.Wb(0,"th",34),b.Kc(1," Type "),b.Vb())}function w(t,i){if(1&t&&(b.Wb(0,"span"),b.Kc(1),b.Vb()),2&t){var e=b.mc().$implicit;b.Cb(1),b.Lc(e.type_label)}}function T(t,i){if(1&t&&(b.Wb(0,"mat-option",33),b.Kc(1),b.Vb()),2&t){var e=i.$implicit;b.sc("value",e.key),b.Cb(1),b.Lc(e.value)}}function D(t,i){if(1&t){var e=b.Xb();b.Wb(0,"mat-form-field"),b.Wb(1,"mat-select",37),b.ic("ngModelChange",(function(t){return b.Bc(e),b.mc().$implicit.type=t}))("selectionChange",(function(t){b.Bc(e);var i=b.mc().$implicit;return b.mc().setPrice(i)})),b.Ic(2,T,2,2,"mat-option",7),b.Vb(),b.Vb()}if(2&t){var n=b.mc().$implicit,a=b.mc();b.Cb(1),b.sc("ngModel",n.type),b.Cb(1),b.sc("ngForOf",a.station.service_types)}}function K(t,i){if(1&t&&(b.Wb(0,"td",35),b.Ic(1,w,2,1,"span",36),b.Ic(2,D,3,2,"mat-form-field",36),b.Vb()),2&t){var e=i.$implicit;b.Cb(1),b.sc("ngIf",e.valid),b.Cb(1),b.sc("ngIf",!e.valid)}}function q(t,i){1&t&&(b.Wb(0,"th",34),b.Kc(1," Size "),b.Vb())}function M(t,i){if(1&t&&(b.Wb(0,"span"),b.Kc(1),b.Vb()),2&t){var e=b.mc().$implicit;b.Cb(1),b.Lc(e.is_scanning?"N/A":e.paper_size.description)}}function z(t,i){if(1&t&&(b.Wb(0,"mat-option",33),b.Kc(1),b.Vb()),2&t){var e=i.$implicit;b.sc("value",e.id),b.Cb(1),b.Lc(e.description)}}function k(t,i){if(1&t){var e=b.Xb();b.Wb(0,"mat-form-field"),b.Wb(1,"mat-select",38),b.ic("ngModelChange",(function(t){return b.Bc(e),b.mc().$implicit.paper_size_id=t}))("selectionChange",(function(t){b.Bc(e);var i=b.mc().$implicit;return b.mc().setPrice(i)})),b.Ic(2,z,2,2,"mat-option",7),b.Vb(),b.Vb()}if(2&t){var n=b.mc().$implicit,a=b.mc();b.Cb(1),b.sc("disabled",n.is_scanning)("ngModel",n.paper_size_id),b.Cb(1),b.sc("ngForOf",a.paper_sizes)}}function $(t,i){if(1&t&&(b.Wb(0,"td",35),b.Ic(1,M,2,1,"span",36),b.Ic(2,k,3,3,"mat-form-field",36),b.Vb()),2&t){var e=i.$implicit;b.Cb(1),b.sc("ngIf",e.valid),b.Cb(1),b.sc("ngIf",!e.valid)}}function O(t,i){1&t&&(b.Wb(0,"th",34),b.Kc(1," Quality "),b.Vb())}function R(t,i){if(1&t&&(b.Wb(0,"span"),b.Kc(1),b.Vb()),2&t){var e=b.mc().$implicit;b.Cb(1),b.Lc(e.is_scanning?"N/A":e.print_quality.description)}}function L(t,i){if(1&t&&(b.Wb(0,"mat-option",33),b.Kc(1),b.Vb()),2&t){var e=i.$implicit;b.sc("value",e.id),b.Cb(1),b.Lc(e.description)}}function Q(t,i){if(1&t){var e=b.Xb();b.Wb(0,"mat-form-field"),b.Wb(1,"mat-select",40),b.ic("ngModelChange",(function(t){return b.Bc(e),b.mc().$implicit.print_quality_id=t}))("selectionChange",(function(t){b.Bc(e);var i=b.mc().$implicit;return b.mc().setPrice(i)})),b.Ic(2,L,2,2,"mat-option",7),b.Vb(),b.Vb()}if(2&t){var n=b.mc().$implicit,a=b.mc();b.Cb(1),b.sc("disabled",n.is_scanning)("ngModel",n.print_quality_id),b.Cb(1),b.sc("ngForOf",a.print_qualities)}}function x(t,i){if(1&t&&(b.Wb(0,"td",39),b.Ic(1,R,2,1,"span",36),b.Ic(2,Q,3,3,"mat-form-field",36),b.Vb()),2&t){var e=i.$implicit;b.Cb(1),b.sc("ngIf",e.valid),b.Cb(1),b.sc("ngIf",!e.valid)}}function P(t,i){1&t&&(b.Wb(0,"th",34),b.Kc(1," Quantity "),b.Vb())}function U(t,i){if(1&t){var e=b.Xb();b.Wb(0,"mat-form-field"),b.Wb(1,"input",42),b.ic("ngModelChange",(function(t){return b.Bc(e),b.mc().$implicit.quantity=t})),b.Vb(),b.Vb()}if(2&t){var n=b.mc().$implicit;b.Cb(1),b.sc("ngModel",n.quantity)}}function j(t,i){if(1&t&&(b.Wb(0,"td",41),b.Ic(1,U,2,1,"mat-form-field",36),b.Vb()),2&t){var e=i.$implicit;b.Cb(1),b.sc("ngIf",e.is_ready)}}function B(t,i){1&t&&(b.Wb(0,"th",43),b.Kc(1," Price "),b.Vb())}function F(t,i){if(1&t&&(b.Wb(0,"span"),b.Kc(1),b.Vb()),2&t){var e=b.mc().$implicit;b.Cb(1),b.Lc(e.price)}}function A(t,i){if(1&t&&(b.Wb(0,"td",41),b.Ic(1,F,2,1,"span",36),b.Vb()),2&t){var e=i.$implicit;b.Cb(1),b.sc("ngIf",e.is_ready)}}function H(t,i){1&t&&(b.Wb(0,"th",44),b.Kc(1," Amount "),b.Vb())}function Y(t,i){if(1&t&&(b.Wb(0,"span"),b.Kc(1),b.Vb()),2&t){var e=b.mc().$implicit;b.Cb(1),b.Lc(e.computed_total)}}function N(t,i){if(1&t&&(b.Wb(0,"td",41),b.Ic(1,Y,2,1,"span",36),b.Vb()),2&t){var e=i.$implicit;b.Cb(1),b.sc("ngIf",e.is_ready)}}function J(t,i){1&t&&b.Rb(0,"th",45)}function X(t,i){1&t&&(b.Wb(0,"mat-icon"),b.Kc(1,"remove"),b.Vb())}function E(t,i){1&t&&(b.Wb(0,"mat-icon"),b.Kc(1,"refresh"),b.Vb())}function G(t,i){if(1&t){var e=b.Xb();b.Wb(0,"button",48),b.ic("click",(function(t){b.Bc(e);var i=b.mc().$implicit;return b.mc().removeItem(i)})),b.Ic(1,X,2,0,"mat-icon",36),b.Ic(2,E,2,0,"mat-icon",36),b.Vb()}if(2&t){var n=b.mc().$implicit,a=b.mc();b.Cb(1),b.sc("ngIf",n.valid),b.Cb(1),b.sc("ngIf",n.dirty&&a.transaction.transaction_items.length>1)}}function Z(t,i){if(1&t&&(b.Wb(0,"td",46),b.Ic(1,G,3,2,"button",47),b.Vb()),2&t){var e=i.$implicit,n=b.mc();b.Cb(1),b.sc("ngIf",e.valid||n.transaction.transaction_items.length>1)}}function tt(t,i){1&t&&b.Rb(0,"tr",49)}function it(t,i){1&t&&b.Rb(0,"tr",50)}function et(t,i){if(1&t){var e=b.Xb();b.Wb(0,"button",51),b.ic("click",(function(t){return b.Bc(e),b.mc().addItem()})),b.Rb(1,"i",52),b.Vb()}}var nt=function(){function t(t,i,e,n){this.dialogRef=t,this.modalService=i,this.serviceTransactionService=e,this.matData=n,this.members=[{id:"1",fullname:"Anonymous"}],this.transactionItemTableColumns=["type","size","quality","quantity","price","total","action"],this.savingTransaction=!1,this.service_rates=[],this.transaction=new l,this.transaction.member_id="1",this.transaction.timeFormatted=c(new Date,"MMM DD, YYYY hh:mm A"),this.currentTransactionItem=new u,this.transaction.transaction_items=[this.currentTransactionItem],this.mds=new s.k(this.transaction.transaction_items),this.station=this.matData.station,this.paper_sizes=this.matData.paper_sizes,this.print_qualities=this.matData.print_qualities,this.service_rates=this.matData.service_rates}return t.prototype.ngOnInit=function(){},t.prototype.ngAfterViewInit=function(){},t.prototype.addItem=function(){this.currentTransactionItem.is_ready&&(this.checkDuplicates()||(this.currentTransactionItem.markAsValid(),this.currentTransactionItem=new u,this.transaction.transaction_items.push(this.currentTransactionItem)),this.mds.connect().next(this.transaction.transaction_items),this.transaction.computeSales())},t.prototype.checkDuplicates=function(){var t=this,i=!1;return this.transaction.transaction_items.forEach((function(e,n){!i&&t.currentTransactionItem.is_printing&&e.valid&&e.paper_size_id===t.currentTransactionItem.paper_size_id&&e.print_quality_id===t.currentTransactionItem.print_quality_id&&(i=!0,e.quantity+=t.currentTransactionItem.quantity,t.currentTransactionItem.reset()),!i&&t.currentTransactionItem.is_scanning&&e.is_scanning&&e.valid&&(i=!0,e.quantity+=t.currentTransactionItem.quantity,t.currentTransactionItem.reset())})),i},t.prototype.removeItem=function(t){t.valid?this.transaction.transaction_items=this.transaction.transaction_items.filter((function(i){return i.paper_size_id!=t.paper_size_id&&i.print_quality_id!=t.print_quality_id&&i.valid})):this.currentTransactionItem.reset(),this.mds.connect().next(this.transaction.transaction_items)},t.prototype.saveTransaction=function(){var t=this;this.modalService.confirm({message:"Save this transaction?"}).then((function(i){i&&(t.checkDuplicates(),t.currentTransactionItem.is_ready&&t.addItem(),t.transaction.transaction_items=t.transaction.transaction_items.filter((function(t){return t.valid})),t.transaction.station_id=t.station.id,t.savingTransaction=!0,t.serviceTransactionService.create(t.transaction).subscribe((function(i){t.modalService.toast("Transaction saved!"),t.dialogRef.close(i),t.savingTransaction=!1}),(function(i){t.modalService.swal({title:"Saving Transaction Failed",text:"Unknown Error Occured",icon:"error"}),t.savingTransaction=!1})))}))},t.prototype.setPrice=function(t){2==t.type?(t.paper_size_id=null,t.print_quality_id=null,console.log(this.service_rates.filter((function(t){return t.is_scanning}))),t.price=this.service_rates.filter((function(t){return t.is_scanning}))[0].rate):(t.paper_size_id&&(t.paper_size=this.paper_sizes.filter((function(i){return i.id==t.paper_size_id}))[0]),t.print_quality_id&&(t.print_quality=this.print_qualities.filter((function(i){return i.id==t.print_quality_id}))[0]),t.paper_size_id&&t.print_quality_id&&(t.price=this.service_rates.filter((function(i){return i.is_printing&&i.paper_size_id==t.paper_size_id&&i.print_quality_id==t.print_quality_id}))[0].rate))},t.\u0275fac=function(i){return new(i||t)(b.Qb(a.g),b.Qb(m.a),b.Qb(p),b.Qb(a.a))},t.\u0275cmp=b.Kb({type:t,selectors:[["app-create-transaction"]],viewQuery:function(t,i){var e;1&t&&b.Pc(V,!0),2&t&&b.zc(e=b.jc())&&(i.cancelButton=e.first)},decls:56,vars:15,consts:[["mat-dialog-title",""],[1,"fa","fa-print"],[1,"mat-typography"],[1,"row"],[1,"col-lg-3"],[1,"full-width"],[3,"ngModel","disabled","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["matInput","","disabled","",3,"ngModel","ngModelChange"],[1,"p-1","bg-primary"],[1,"col-lg-12"],["mat-table","",1,"full-width",3,"dataSource"],["matColumnDef","type"],["mat-header-cell","","style","width: 20%;",4,"matHeaderCellDef"],["mat-cell","","class","pr-3",4,"matCellDef"],["matColumnDef","size"],["matColumnDef","quality"],["mat-cell","","class","p-2",4,"matCellDef"],["matColumnDef","quantity"],["mat-cell","","class","text-center",4,"matCellDef"],["matColumnDef","price"],["mat-header-cell","","style","width: 20%;","class","text-center",4,"matHeaderCellDef"],["matColumnDef","total",2,"width","10%"],["mat-header-cell","","class","text-center",4,"matHeaderCellDef"],["matColumnDef","action"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["align","end"],["mat-raised-button","",3,"click",4,"ngIf"],["mat-raised-button","",3,"disabled","click"],["mat-button","","mat-dialog-close","",3,"disabled"],[3,"value"],["mat-header-cell","",2,"width","20%"],["mat-cell","",1,"pr-3"],[4,"ngIf"],["aria-placeholder","Size",3,"ngModel","ngModelChange","selectionChange"],["aria-placeholder","Size",3,"disabled","ngModel","ngModelChange","selectionChange"],["mat-cell","",1,"p-2"],["aria-placeholder","Quality",3,"disabled","ngModel","ngModelChange","selectionChange"],["mat-cell","",1,"text-center"],["matInput","","type","number","autocomplete","off","min","1",1,"text-center",3,"ngModel","ngModelChange"],["mat-header-cell","",1,"text-center",2,"width","20%"],["mat-header-cell","",1,"text-center"],["mat-header-cell",""],["mat-cell",""],["mat-raised-button","","color","error",3,"click",4,"ngIf"],["mat-raised-button","","color","error",3,"click"],["mat-header-row",""],["mat-row",""],["mat-raised-button","",3,"click"],[1,"fa","fa-plus"]],template:function(t,i){1&t&&(b.Wb(0,"h2",0),b.Rb(1,"i",1),b.Kc(2," New Print Transaction"),b.Vb(),b.Wb(3,"mat-dialog-content",2),b.Wb(4,"div",3),b.Wb(5,"div",4),b.Wb(6,"mat-form-field",5),b.Wb(7,"mat-label"),b.Kc(8,"Member"),b.Vb(),b.Wb(9,"mat-select",6),b.ic("ngModelChange",(function(t){return i.transaction.member_id=t})),b.Ic(10,W,2,2,"mat-option",7),b.Vb(),b.Vb(),b.Vb(),b.Wb(11,"div",4),b.Wb(12,"mat-form-field",5),b.Wb(13,"mat-label"),b.Kc(14,"Transacttion Time"),b.Vb(),b.Wb(15,"input",8),b.ic("ngModelChange",(function(t){return i.transaction.time=t})),b.Vb(),b.Vb(),b.Vb(),b.Wb(16,"div",4),b.Wb(17,"h2",9),b.Kc(18),b.nc(19,"currency"),b.Vb(),b.Vb(),b.Vb(),b.Wb(20,"div",3),b.Wb(21,"div",10),b.Wb(22,"table",11),b.Ub(23,12),b.Ic(24,S,2,0,"th",13),b.Ic(25,K,3,2,"td",14),b.Tb(),b.Ub(26,15),b.Ic(27,q,2,0,"th",13),b.Ic(28,$,3,2,"td",14),b.Tb(),b.Ub(29,16),b.Ic(30,O,2,0,"th",13),b.Ic(31,x,3,2,"td",17),b.Tb(),b.Ub(32,18),b.Ic(33,P,2,0,"th",13),b.Ic(34,j,2,1,"td",19),b.Tb(),b.Ub(35,20),b.Ic(36,B,2,0,"th",21),b.Ic(37,A,2,1,"td",19),b.Tb(),b.Ub(38,22),b.Ic(39,H,2,0,"th",23),b.Ic(40,N,2,1,"td",19),b.Tb(),b.Ub(41,24),b.Ic(42,J,1,0,"th",25),b.Ic(43,Z,2,1,"td",26),b.Tb(),b.Ic(44,tt,1,0,"tr",27),b.Ic(45,it,1,0,"tr",28),b.Vb(),b.Vb(),b.Vb(),b.Vb(),b.Wb(46,"mat-dialog-actions",29),b.Ic(47,et,2,0,"button",30),b.Wb(48,"button",31),b.ic("click",(function(t){return i.saveTransaction()})),b.Wb(49,"mat-icon"),b.Kc(50,"save"),b.Vb(),b.Kc(51),b.Vb(),b.Wb(52,"button",32),b.Wb(53,"mat-icon"),b.Kc(54,"remove"),b.Vb(),b.Kc(55," Cancel"),b.Vb(),b.Vb()),2&t&&(b.Cb(9),b.sc("ngModel",i.transaction.member_id)("disabled",!0),b.Cb(1),b.sc("ngForOf",i.members),b.Cb(5),b.sc("ngModel",i.transaction.time),b.Cb(3),b.Mc("Total: ",b.pc(19,12,i.transaction.sales," "),""),b.Cb(4),b.sc("dataSource",i.mds),b.Cb(22),b.sc("matHeaderRowDef",i.transactionItemTableColumns),b.Cb(1),b.sc("matRowDefColumns",i.transactionItemTableColumns),b.Cb(2),b.sc("ngIf",null==i.currentTransactionItem||i.currentTransactionItem.is_ready&&0==i.currentTransactionItem.valid),b.Cb(1),b.sc("disabled",!i.currentTransactionItem.is_ready&&1==i.transaction.transaction_items.length||i.savingTransaction),b.Cb(3),b.Mc(" ",i.savingTransaction?"Saving Transaction...":"Save Transaction"," "),b.Cb(1),b.sc("disabled",i.savingTransaction))},directives:[a.h,a.e,h.b,h.e,v.a,g.k,g.n,n.l,_.a,g.b,s.j,s.c,s.e,s.b,s.g,s.i,a.c,n.m,y.b,I.a,a.d,C.h,s.d,s.a,g.p,s.f,s.h],pipes:[n.d],styles:[""]}),t}(),at=e("SWMs"),ct=e("DUip"),st=function(t){function i(i){var e=t.call(this,i,"stations")||this;return e.http=i,e}return Object(r.b)(i,t),i.prototype.use=function(t,i){return this.http.put(this.uri+"/"+t.id,{use:1,password:i})},i.prototype.leave=function(t,i){return this.http.put(this.uri+"/"+t.id,{leave:1,password:i})},i.\u0275fac=function(t){return new(t||i)(b.ec(f.b))},i.\u0275prov=b.Mb({token:i,factory:i.\u0275fac,providedIn:"root"}),i}(d.a),rt=e("l5Kb"),ot=e("iPKQ"),lt=e("0gkb"),ut=e("o9IV"),bt=e("chSY"),mt=e("17Os"),dt=e("H6It"),ft=e("/RhQ");function pt(t,i){if(1&t){var e=b.Xb();b.Wb(0,"button",16),b.ic("click",(function(t){return b.Bc(e),b.mc(2).newTransaction()})),b.Kc(1,"New Transaction "),b.Vb()}if(2&t){var n=b.mc(2);b.sc("disabled",!n.paper_sizes||!n.print_qualities||!n.service_rates)}}function ht(t,i){1&t&&(b.Wb(0,"h3",17),b.Kc(1,"Loading..."),b.Vb())}function vt(t,i){1&t&&(b.Wb(0,"th",18),b.Kc(1,"Time"),b.Vb())}function gt(t,i){if(1&t&&(b.Wb(0,"td",19),b.Kc(1),b.nc(2,"dfnsFormat"),b.nc(3,"parseDate"),b.Vb()),2&t){var e=i.$implicit;b.Cb(1),b.Mc(" ",b.pc(2,1,b.oc(3,4,e.time),"hh:mm A MMM DD, YYYY")," ")}}function _t(t,i){1&t&&(b.Wb(0,"th",18),b.Kc(1,"Member"),b.Vb())}function yt(t,i){if(1&t&&(b.Wb(0,"td",19),b.Kc(1),b.Vb()),2&t){var e=i.$implicit;b.Cb(1),b.Mc(" ",e.member.fullname," ")}}function It(t,i){1&t&&(b.Wb(0,"th",18),b.Kc(1,"Sales"),b.Vb())}function Ct(t,i){if(1&t&&(b.Wb(0,"td",20),b.Kc(1),b.nc(2,"currency"),b.Vb()),2&t){var e=i.$implicit;b.Cb(1),b.Mc(" ",b.pc(2,1,e.sales," ")," ")}}function Vt(t,i){1&t&&b.Rb(0,"tr",21)}function Wt(t,i){1&t&&b.Rb(0,"tr",22)}function St(t,i){if(1&t&&(b.Wb(0,"span"),b.Kc(1),b.Rb(2,"br"),b.Vb()),2&t){var e=b.mc(2);b.Cb(1),b.Mc("Current user is ",e.station.current_session.user.fullname," ")}}function wt(t,i){if(1&t&&(b.Wb(0,"h1"),b.Kc(1),b.nc(2,"currency"),b.Wb(3,"small"),b.Kc(4,"Total Sales"),b.Vb(),b.Vb()),2&t){var e=b.mc(2);b.Cb(1),b.Mc("",b.pc(2,1,e.sales," ")," ")}}function Tt(t,i){if(1&t){var e=b.Xb();b.Wb(0,"button",23),b.ic("click",(function(t){return b.Bc(e),b.mc(2).leaveSession()})),b.Wb(1,"mat-icon"),b.Kc(2,"exit_to_app"),b.Vb(),b.Kc(3),b.Vb()}if(2&t){var n=b.mc(2);b.sc("disabled",n.isLeaving),b.Cb(3),b.Mc(" ",n.isLeaving?"Leaving Session...":"Leave Session","")}}function Dt(t,i){if(1&t&&(b.Wb(0,"div"),b.Wb(1,"div",2),b.Wb(2,"div",3),b.Wb(3,"mat-card"),b.Wb(4,"mat-card-header"),b.Wb(5,"mat-card-title"),b.Kc(6),b.Vb(),b.Wb(7,"mat-card-subtitle"),b.Rb(8,"br"),b.Ic(9,pt,2,1,"button",4),b.Vb(),b.Vb(),b.Wb(10,"mat-card-content"),b.Ic(11,ht,2,0,"h3",1),b.Wb(12,"table",5),b.Ub(13,6),b.Ic(14,vt,2,0,"th",7),b.Ic(15,gt,4,6,"td",8),b.Tb(),b.Ub(16,9),b.Ic(17,_t,2,0,"th",7),b.Ic(18,yt,2,1,"td",8),b.Tb(),b.Ub(19,10),b.Ic(20,It,2,0,"th",7),b.Ic(21,Ct,3,4,"td",11),b.Tb(),b.Ic(22,Vt,1,0,"tr",12),b.Ic(23,Wt,1,0,"tr",13),b.Vb(),b.Vb(),b.Vb(),b.Vb(),b.Wb(24,"div",14),b.Wb(25,"mat-card"),b.Wb(26,"mat-card-header"),b.Wb(27,"mat-card-title"),b.Kc(28,"Session Summary"),b.Vb(),b.Vb(),b.Wb(29,"mat-card-content"),b.Ic(30,St,3,1,"span",0),b.Kc(31),b.nc(32,"dfnsDistanceInWordsToNow"),b.nc(33,"parseDate"),b.Rb(34,"br"),b.Rb(35,"br"),b.Ic(36,wt,5,4,"h1",0),b.Rb(37,"br"),b.Rb(38,"br"),b.Ic(39,Tt,4,2,"button",15),b.Vb(),b.Vb(),b.Vb(),b.Vb(),b.Vb()),2&t){var e=b.mc();b.Cb(6),b.Mc("Transactions on ",e.station.description," "),b.Cb(3),b.sc("ngIf",e.isOnDuty),b.Cb(2),b.sc("ngIf",e.isLoadingTransactions),b.Cb(1),b.sc("dataSource",e.mds),b.Cb(10),b.sc("matHeaderRowDef",e.transactionTableColumns),b.Cb(1),b.sc("matRowDefColumns",e.transactionTableColumns),b.Cb(7),b.sc("ngIf",0==e.isOnDuty),b.Cb(1),b.Mc(" Started ",b.oc(32,10,b.oc(33,12,e.station.current_session.time_in))," ago "),b.Cb(5),b.sc("ngIf",!e.isLoadingTransactions),b.Cb(3),b.sc("ngIf",e.isOnDuty)}}function Kt(t,i){1&t&&(b.Wb(0,"div",17),b.Kc(1," Loading transactions...\n"),b.Vb())}var qt=function(){function t(t,i,e,n,a,c,r,o,l,u,b){this.activatedRoute=t,this.stationService=i,this.modalService=e,this.stateService=n,this.router=a,this.authService=c,this.paperSizeService=r,this.printQualityService=o,this.serviceRateService=l,this.serviceTransacrionService=u,this.dialog=b,this.station=null,this.isLeaving=!1,this.isOnDuty=!1,this.paper_sizes=[],this.print_qualities=[],this.service_rates=[],this.transactionTableColumns=["time","member","sales"],this.sales=0,this.isLoadingTransactions=!0,this.transactions=[],this.mds=new s.k}return t.prototype.ngOnInit=function(){var t=this;this.station=this.stateService.get("active_station"),null==this.station?this.stationService.read(this.activatedRoute.snapshot.params.station).subscribe((function(i){i.current_session?(t.station=i,t.isOnDuty=t.authService.currentUser.id==t.station.current_session.user_id,t.isOnDuty&&t.stateService.set("active_station",i),t.fetchTransactions()):t.router.navigate(["/service-transactions"])}),(function(i){t.modalService.toast("Error reading station"),t.router.navigate(["/service-transactions"])})):(this.isOnDuty=this.authService.currentUser.id==this.station.current_session.user_id,this.fetchTransactions()),this.fetchConfig()},t.prototype.fetchConfig=function(){var t=this;this.paper_sizes=this.stateService.get("paper_sizes"),this.print_qualities=this.stateService.get("print_qualities"),this.service_rates=this.stateService.get("service_rates"),null==this.paper_sizes&&this.paperSizeService.query().subscribe((function(i){t.paper_sizes=i,t.stateService.set("paper_sizes",i)})),null==this.print_qualities&&this.printQualityService.query().subscribe((function(i){t.print_qualities=i,t.stateService.set("print_qualities",i)})),null==this.service_rates&&this.serviceRateService.query().subscribe((function(i){t.service_rates=i.map((function(t){return(new at.a).fill(t)})),t.stateService.set("service_rates",t.service_rates)}))},t.prototype.leaveSession=function(){var t=this;this.modalService.prompt({question:"Please enter your password to continue",required:!0,password:!0}).then((function(i){i&&(t.isLeaving=!0,t.stationService.leave(t.station,i).subscribe((function(i){t.stateService.set("active_station",null),t.modalService.toast("You leaved the session","Session leaved"),t.router.navigate(["/service-transactions"]),t.isLeaving=!1}),(function(i){"Password is incorrect"==i.error.message?t.modalService.swal({text:"Incorrect password",title:"Oops!",icon:"error"}):t.modalService.toast("Something went wrong","Oops!","error"),t.isLeaving=!1})))}))},t.prototype.newTransaction=function(){var t=this;this.dialog.open(nt,{width:"90%",disableClose:!0,data:{station:this.station,paper_sizes:this.paper_sizes,print_qualities:this.print_qualities,service_rates:this.service_rates}}).afterClosed().subscribe((function(i){i&&(t.transactions.unshift(i),t.mds.connect().next(t.transactions),t.sales+=Number(i.sales))}))},t.prototype.fetchTransactions=function(){var t=this;this.isLoadingTransactions=!0,this.serviceTransacrionService.query({params:{time:this.station.current_session.time_in,station_id:this.station.id}}).subscribe((function(i){t.transactions=i,t.mds.connect().next(t.transactions),t.isLoadingTransactions=!1,t.sales=0,t.transactions.forEach((function(i){t.sales+=Number(i.sales)}))}))},t.\u0275fac=function(i){return new(i||t)(b.Qb(ct.a),b.Qb(st),b.Qb(m.a),b.Qb(rt.a),b.Qb(ct.g),b.Qb(ot.a),b.Qb(lt.a),b.Qb(ut.a),b.Qb(bt.a),b.Qb(p),b.Qb(a.b))},t.\u0275cmp=b.Kb({type:t,selectors:[["app-show"]],decls:2,vars:2,consts:[[4,"ngIf"],["class","text-muted",4,"ngIf"],[1,"row"],[1,"col-lg-8"],["mat-raised-button","","color","primary",3,"disabled","click",4,"ngIf"],["mat-table","",1,"full-width",3,"dataSource"],["matColumnDef","time"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","member"],["matColumnDef","sales"],["mat-cell","","class","text-right pr-2",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"col-lg-4"],["mat-raised-button","","color","warn",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","primary",3,"disabled","click"],[1,"text-muted"],["mat-header-cell",""],["mat-cell",""],["mat-cell","",1,"text-right","pr-2"],["mat-header-row",""],["mat-row",""],["mat-raised-button","","color","warn",3,"disabled","click"]],template:function(t,i){1&t&&(b.Ic(0,Dt,40,14,"div",0),b.Ic(1,Kt,2,0,"div",1)),2&t&&(b.sc("ngIf",i.station&&null!=i.station.current_session),b.Cb(1),b.sc("ngIf",null==i.station))},directives:[n.m,mt.a,mt.d,mt.g,mt.f,mt.c,s.j,s.c,s.e,s.b,s.g,s.i,y.b,s.d,s.a,s.f,s.h,I.a],pipes:[dt.c,ft.a,dt.d,n.d],styles:[""]}),t}();function Mt(t,i){if(1&t&&(b.Wb(0,"div"),b.Kc(1," Logged User: "),b.Wb(2,"span",5),b.Kc(3),b.Vb(),b.Rb(4,"br"),b.Rb(5,"br"),b.Wb(6,"a",6),b.Kc(7,"View Transactions"),b.Vb(),b.Vb()),2&t){var e=b.mc().$implicit;b.Cb(3),b.Lc(e.current_session.user.fullname),b.Cb(3),b.sc("routerLink","/service-transactions/"+e.id)}}function zt(t,i){if(1&t&&(b.Wb(0,"span"),b.Kc(1),b.nc(2,"dfnsDistanceInWordsToNow"),b.nc(3,"parseDate"),b.Vb()),2&t){var e=b.mc(2).$implicit;b.Cb(1),b.Nc(" Last used by ",e.previous_session.user.firstname," ",b.oc(2,2,b.oc(3,4,e.previous_session.time_out))," ago ")}}function kt(t,i){if(1&t){var e=b.Xb();b.Wb(0,"div",7),b.Ic(1,zt,4,6,"span",0),b.Rb(2,"br"),b.Rb(3,"br"),b.Wb(4,"button",8),b.ic("click",(function(t){b.Bc(e);var i=b.mc().$implicit;return b.mc(2).useStation(i)})),b.Kc(5),b.Vb(),b.Vb()}if(2&t){var n=b.mc().$implicit,a=b.mc(2);b.Cb(1),b.sc("ngIf",n.previous_session),b.Cb(3),b.sc("disabled",a.isJoining),b.Cb(1),b.Lc(a.isJoining?"Processing...":"Use")}}function $t(t,i){if(1&t&&(b.Wb(0,"div",3),b.Wb(1,"mat-card"),b.Wb(2,"mat-card-header"),b.Wb(3,"mat-card-title-group"),b.Wb(4,"mat-card-title"),b.Wb(5,"mat-icon"),b.Kc(6,"desktop_windows"),b.Vb(),b.Kc(7),b.Vb(),b.Vb(),b.Vb(),b.Wb(8,"mat-card-content"),b.Ic(9,Mt,8,2,"div",0),b.Ic(10,kt,6,3,"div",4),b.Vb(),b.Vb(),b.Vb()),2&t){var e=i.$implicit;b.Cb(7),b.Mc(" ",e.description," "),b.Cb(2),b.sc("ngIf",e.current_session),b.Cb(1),b.sc("ngIf",null==e.current_session)}}function Ot(t,i){if(1&t&&(b.Wb(0,"div"),b.Wb(1,"h1"),b.Kc(2,"Choose Station"),b.Vb(),b.Wb(3,"div",1),b.Ic(4,$t,11,3,"div",2),b.Vb(),b.Vb()),2&t){var e=b.mc();b.Cb(4),b.sc("ngForOf",e.stations)}}function Rt(t,i){1&t&&(b.Wb(0,"h1"),b.Kc(1,"Loading Stations..."),b.Vb())}var Lt=[{path:"",component:function(){function t(t,i,e,n,a){this.stationService=t,this.authService=i,this.router=e,this.stateService=n,this.modalService=a,this.fetchingStations=!1,this.isJoining=!1}return t.prototype.ngOnInit=function(){var t=this.stateService.get("active_station");t?this.setActiveStation(t):this.fetchStations()},t.prototype.fetchStations=function(){var t=this;this.fetchingStations=!0,this.stationService.query().subscribe((function(i){var e=null;i.forEach((function(i){i.current_session&&i.current_session.user_id==t.authService.currentUser.id&&(e=i)})),null==e?t.stations=i:t.setActiveStation(e),t.fetchingStations=!1}))},t.prototype.useStation=function(t){var i=this;this.modalService.prompt({question:"Please enter your password to continue",required:!0,password:!0}).then((function(e){e&&(i.isJoining=!0,i.stationService.use(t,e).subscribe((function(t){i.isJoining=!1,i.setActiveStation(t)}),(function(t){i.isJoining=!1,i.modalService.alert({message:"Password is not correct",type:"warn"})})))}))},t.prototype.setActiveStation=function(t){this.stateService.set("active_station",t),this.router.navigate(["/service-transactions/"+t.id])},t.\u0275fac=function(i){return new(i||t)(b.Qb(st),b.Qb(ot.a),b.Qb(ct.g),b.Qb(rt.a),b.Qb(m.a))},t.\u0275cmp=b.Kb({type:t,selectors:[["app-index"]],decls:2,vars:2,consts:[[4,"ngIf"],[1,"row"],["class","col-lg-3",4,"ngFor","ngForOf"],[1,"col-lg-3"],["class","text-muted",4,"ngIf"],[1,"text-primary"],["mat-raised-button","","color","primary",3,"routerLink"],[1,"text-muted"],["mat-raised-button","","color","primary",3,"disabled","click"]],template:function(t,i){1&t&&(b.Ic(0,Ot,5,1,"div",0),b.Ic(1,Rt,2,0,"h1",0)),2&t&&(b.sc("ngIf",i.stations),b.Cb(1),b.sc("ngIf",i.fetchingStations))},directives:[n.m,n.l,mt.a,mt.d,mt.h,mt.g,I.a,mt.c,y.a,ct.j,y.b],pipes:[dt.c,ft.a],styles:[""]}),t}()},{path:":station",component:qt}],Qt=function(){function t(){}return t.\u0275mod=b.Ob({type:t}),t.\u0275inj=b.Nb({factory:function(i){return new(i||t)},imports:[[ct.k.forChild(Lt)],ct.k]}),t}(),xt=e("FpXt");e.d(i,"ServiceTransactionsModule",(function(){return Pt}));var Pt=function(){function t(){}return t.\u0275mod=b.Ob({type:t}),t.\u0275inj=b.Nb({factory:function(i){return new(i||t)},imports:[[n.c,Qt,xt.a]]}),t}()}}]);